import{_ as o,j as e,o as t,g as c,k as l,h as a,Q as p,s}from"./chunks/framework.e0c66c3f.js";const $=JSON.parse('{"title":"微服务链路追踪 ","description":"","frontmatter":{},"headers":[],"relativePath":"posts/backEnd/SpringCloud Alibaba 实战_文档/(6759) 14  链路跟踪：基于 Sleuth+Zipkin 实施链路跟踪体系.md","filePath":"posts/backEnd/SpringCloud Alibaba 实战_文档/(6759) 14  链路跟踪：基于 Sleuth+Zipkin 实施链路跟踪体系.md","lastUpdated":1696338709000}'),r={name:"posts/backEnd/SpringCloud Alibaba 实战_文档/(6759) 14  链路跟踪：基于 Sleuth+Zipkin 实施链路跟踪体系.md"},y=p("",5),E=p("",8),i=p("",7),d=s("p",null,"链路追踪图表",-1),g=s("p",null,"通过这个图表可以非常直观的了解业务处理过程中服务间的依赖关系与处理时间、处理状态等信息，是开发运维人员进行故障分析时必要的工具。",-1),F=s("p",null,"说到这，想必你对服务链路追踪与 Sleuth+Zipkin 组合已经有了初步认识，下面咱们通过实例讲解如何在微服务架构中进行链路追踪。这个过程分为两个阶段：",-1),C=s("ul",null,[s("li",null,[s("p",null,"在服务中加入 Spring Cloud Sleuth 生成链路追踪日志；")]),s("li",null,[s("p",null,"通过 ZipKin 收集链路最终日志，生成可视化图表。")])],-1),u=s("h3",{id:"微服务整合-sleuth",tabindex:"-1"},[a("微服务整合 Sleuth "),s("a",{class:"header-anchor",href:"#微服务整合-sleuth","aria-label":'Permalink to "微服务整合 Sleuth"'},"​")],-1),A=s("p",null,"为了演示需要，这里创建 a-service、b-service、c-service 三个微服务工程，配置过程十分简单，我们把关键代码拿出来说明。",-1),h=p("",29),D=s("p",null,"Zipkin 的架构示意图",-1),v=s("p",null,"在部署 Zipkin 服务端后，一旦微服务产生链路追踪日志，Zipkin 客户端便会自动以异步形式将日志数据推送至 Zipkin 服务端，Zipkin 服务端对数据进行组织整理，开发运维人员便可通过 Zipkin 服务端提供的 UI 界面进行查看。下面咱们来讲解 Zipkin 服务端与客户端的部署过程。",-1),b=s("h3",{id:"部署-zipkin-服务端",tabindex:"-1"},[a("部署 Zipkin 服务端 "),s("a",{class:"header-anchor",href:"#部署-zipkin-服务端","aria-label":'Permalink to "部署 Zipkin 服务端"'},"​")],-1),B=s("p",null,"Zipkin 服务端部署非常简单，可以通过官网快速上手。",-1),_=s("p",null,[s("a",{href:"https://zipkin.io/pages/quickstart.html?fileGuid=xxQTRXtVcqtHK6j8",target:"_blank",rel:"noreferrer"},"https://zipkin.io/pages/quickstart.html"),a("。")],-1),m=p("",3),k=p("",5),S=p("",12),f=s("p",null,"查询调用链路",-1),I=s("p",null,"查询结果",-1),q=s("p",null,"点击执行之间的蓝条，便会出现对应的链路调用图。",-1),T=s("p",null,"链路条调用图",-1),x=s("p",null,"通过这个图可以直观了解到 ABC 三个服务的执行时间、执行顺序、访问地址、访问方式以及是否执行成功。如果你点击对应的色条，还可以看到更详细的内容。",-1),Z=s("p",null,"链路调用明细",-1),P=s("p",null,'下面咱们做一个实验，将 C 服务停止，看链路图会产生什么变化。停止后再次访问 A 服务报 500 错误"java.net.SocketTimeoutException: Read timed out"。此时链路追踪图会显示错误。',-1),j=s("p",null,"异常情况下的链路追踪",-1),R=s("p",null,"通过图表发现最后 b-service 只有 6 纳秒执行时间肯定是有问题的，点击后查看明细。",-1),G=s("p",null,"异常明细",-1),M=s("p",null,"异常信息已经非常清晰的说明 C 服务没有可用的实例导致处理失败，开发人员针对这个问题进行及时补救即可。",-1),V=s("p",null,"讲到这里，我们通过实例的形式带你搭建了基于 Sleuth+Zipkin 的链路追踪的基础架构，下面我们进行一下总结。",-1),w=s("h3",{id:"小结与总结",tabindex:"-1"},[a("小结与总结 "),s("a",{class:"header-anchor",href:"#小结与总结","aria-label":'Permalink to "小结与总结"'},"​")],-1),z=s("p",null,"本讲咱们学习了三方面内容，首先介绍了链路追踪的作用并分析了 Sleuth+Zipkin 基于日志追踪的原理；其次我们掌握了 Sleuth 的部署方法，只需要引入 Sleuth 的依赖即可；最后介绍了如何引入 Zipkin 实现可视化链路追踪，并模拟了异常情况。",-1),U=s("p",null,"这里咱们留一道讨论题：在日常的开发过程中，研发人员会开发各种不同功能的 RESTful 接口，如何将这些接口的文档化以及如何对这些接口进行版本管理呢？如果你有这方面经验，不妨写在评论中和大家一起分享下。",-1),N=s("p",null,"下一讲，我们将介绍另一款国产的链路跟踪产品 SkyWalking 的使用办法。",-1);function L(O,W,H,K,J,X){const n=e("Image");return t(),c("div",null,[y,l(n,{alt:"图片1.png",src:"https://s0.lgstatic.com/i/image6/M01/2C/A5/Cgp9HWBldo6APrO6AAEGOxZjZu0392.png"}),a(),E,l(n,{alt:"图片2.png",src:"https://s0.lgstatic.com/i/image6/M01/2C/AD/CioPOWBldpiAAEEzAAEIV3dI0v0620.png"}),a(),i,l(n,{alt:"图片3.png",src:"https://s0.lgstatic.com/i/image6/M01/2C/A5/Cgp9HWBldqaAet1VAAEhVL4p5dM017.png"}),a(),d,g,F,C,u,A,l(n,{alt:"图片4.png",src:"https://s0.lgstatic.com/i/image6/M01/2C/AD/CioPOWBldrOAGWTLAABgPlbPohY295.png"}),a(),h,l(n,{alt:"图片5.png",src:"https://s0.lgstatic.com/i/image6/M00/2C/A6/Cgp9HWBldtqACzyVAAEeD5EF8GE518.png"}),a(),D,v,b,B,_,l(n,{alt:"图片6.png",src:"https://s0.lgstatic.com/i/image6/M00/2C/A6/Cgp9HWBlduaAKJDQAAHelVn9Llw043.png"}),a(),m,l(n,{alt:"图片7.png",src:"https://s0.lgstatic.com/i/image6/M00/2C/AE/CioPOWBldu-AfKZTAAVsfFaI5dg233.png"}),a(),k,l(n,{alt:"图片8.png",src:"https://s0.lgstatic.com/i/image6/M00/2C/A6/Cgp9HWBldvuAB7WhAACcYRFoBMA812.png"}),a(),S,l(n,{alt:"图片9.png",src:"https://s0.lgstatic.com/i/image6/M00/2C/A6/Cgp9HWBldwyANV6BAAEIr9R5lAA439.png"}),a(),f,l(n,{alt:"图片10.png",src:"https://s0.lgstatic.com/i/image6/M00/2C/A6/Cgp9HWBldxOAUW52AACpYTg2JiM395.png"}),a(),I,q,l(n,{alt:"图片11.png",src:"https://s0.lgstatic.com/i/image6/M00/2C/A6/Cgp9HWBldxuAOUJJAADMMxuCCC4773.png"}),a(),T,x,l(n,{alt:"图片12.png",src:"https://s0.lgstatic.com/i/image6/M00/2C/A6/Cgp9HWBldyKAKVZTAAFwUrk3trU141.png"}),a(),Z,P,l(n,{alt:"图片13.png",src:"https://s0.lgstatic.com/i/image6/M00/2C/AF/CioPOWBldymALd3wAACKH8C4Co8299.png"}),a(),j,R,l(n,{alt:"图片14.png",src:"https://s0.lgstatic.com/i/image6/M00/2C/AF/CioPOWBldzCAFF3MAAG2T6bpl4w635.png"}),a(),G,M,V,w,z,U,N])}const Y=o(r,[["render",L]]);export{$ as __pageData,Y as default};
