import{_ as t,j as a,o as e,g as _,k as o,h as l,Q as p,s as i}from"./chunks/framework.a0d18f64.js";const X=JSON.parse('{"title":"第02讲：深入理解事务与锁机制（下）","description":"","frontmatter":{},"headers":[],"relativePath":"posts/backEnd/040_高性能MySQL实战/(50) 第02讲：深入理解事务与锁机制（下）.md","filePath":"posts/backEnd/040_高性能MySQL实战/(50) 第02讲：深入理解事务与锁机制（下）.md","lastUpdated":1696682708000}'),s={name:"posts/backEnd/040_高性能MySQL实战/(50) 第02讲：深入理解事务与锁机制（下）.md"},d=p("",5),c=p("",10),r=i("p",null,"InnoDB 锁关系矩阵如下图所示，其中：+ 表示兼容，- 表示不兼容。",-1),h=p("",10),u=i("p",null,"假设条件是：",-1),A=i("ul",null,[i("li",null,[i("p",null,"update t1 set name='XX' where id=10。")]),i("li",null,[i("p",null,"id 为主键索引。")])],-1),m=i("p",null,"加锁行为：仅在 id=10 的主键索引记录上加 X锁。",-1),I=i("p",null,"第二种情况：唯一键 + RR，如下图所示。",-1),g=p("",5),T=p("",5),D=p("",14),S=i("p",null,"session1 首先拿到 id=1 的锁，session2 同期拿到了 id=5 的锁后，两者分别想拿到对方持有的锁，于是产生死锁。",-1),b=i("h2",{id:"元数据锁",tabindex:"-1"},[l("元数据锁 "),i("a",{class:"header-anchor",href:"#元数据锁","aria-label":'Permalink to "元数据锁"'},"​")],-1),B=i("p",null,"下面分享一个 Metadata lock（即元数据锁）导致的死锁的情况，如下图所示。",-1),k=p("",5);function R(M,C,L,P,V,y){const n=a("Image");return e(),_("div",null,[d,o(n,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/89/D4/CgoB5l13JAaAMAAJAAAVsgPHWMQ811.png"}),l(),c,o(n,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/89/D4/CgoB5l13JAaAE19WAAB04iNLUm8099.png"}),l(),r,o(n,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/89/F4/CgotOV13JAaAPHdtAAAV6sAJZJU546.png"}),l(),h,o(n,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/89/D4/CgoB5l13JAaAbttnAADhQqAn2AA031.png"}),l(),u,A,m,I,o(n,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/89/F4/CgotOV13JAaARFQyAAEDy1rKntM893.png"}),l(),g,o(n,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/89/D4/CgoB5l13JAeAXno8AAEx6KKaJgs480.png"}),l(),T,o(n,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/89/F4/CgotOV13JAeARw3uAAFMccO4RTA164.png"}),l(),D,o(n,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/89/D4/CgoB5l13JAeAGUj0AAIHGdgOf2U103.png"}),l(),S,b,B,o(n,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/89/F4/CgotOV13JAeAfDhaAAKx8-t0UEg960.png"}),l(),k])}const f=t(s,[["render",R]]);export{X as __pageData,f as default};
