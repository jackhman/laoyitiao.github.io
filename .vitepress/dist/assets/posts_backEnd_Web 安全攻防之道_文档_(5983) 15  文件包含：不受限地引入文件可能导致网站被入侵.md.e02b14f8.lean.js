import{_ as o,j as e,o as t,g as c,k as p,h as a,Q as l,s}from"./chunks/framework.b3d8e22e.js";const I=JSON.parse('{"title":"远程文件包含 ","description":"","frontmatter":{},"headers":[],"relativePath":"posts/backEnd/Web 安全攻防之道_文档/(5983) 15  文件包含：不受限地引入文件可能导致网站被入侵.md","filePath":"posts/backEnd/Web 安全攻防之道_文档/(5983) 15  文件包含：不受限地引入文件可能导致网站被入侵.md","lastUpdated":1696417798000}'),r={name:"posts/backEnd/Web 安全攻防之道_文档/(5983) 15  文件包含：不受限地引入文件可能导致网站被入侵.md"},y=l("",11),E=l("",6),i=l("",6),h=l("",21),F=s("p",null,"图 4 利用漏洞读取 /etc/passwd 文件",-1),d=s("h3",{id:"漏洞利用技巧",tabindex:"-1"},[a("漏洞利用技巧 "),s("a",{class:"header-anchor",href:"#漏洞利用技巧","aria-label":'Permalink to "漏洞利用技巧"'},"​")],-1),u=s("p",null,"随着PHP 5.2 之后默认关闭 allow_url_include 配置，也降低了远程文件包含漏洞的出现。但是本地文件包含漏洞的利用方式，很多也适用于远程文件包含漏洞，下面会介绍一些相对通用的利用技巧。",-1),_=s("p",null,"此处漏洞利用的目标仍然是为了获取服务器的 shell 权限，就需要设法在服务器上写入文件，内容自然是一句话等恶意代码内容。但是，我们手上又没有写任意文件的漏洞可利用，只能看看服务器上哪些文件会写入外部用户可控数据，或者其他可执行 PHP 代码的方式。",-1),g=s("p",null,"总结起来，主要有下面几种利用方式。",-1),C=s("h4",{id:"_1-写日志文件",tabindex:"-1"},[a("1.写日志文件 "),s("a",{class:"header-anchor",href:"#_1-写日志文件","aria-label":'Permalink to "1.写日志文件"'},"​")],-1),m=s("p",null,"如果服务器开启访问日志记录的话，那么用户的请求数据就会被记录在日志文件，若我们在地址上包含一句话木马的话，也同样会被记录进去。如果将一句话写在 URL 中常常会被 URL 编码存储，因此需要写 User-Agent 中，其他 HTTP 头默认不会被记录：",-1),A=l("",15),v=s("ul",null,[s("li",{PHPSESSID:""},[s("p",null,"/var/lib/php/sessions/sess_")]),s("li",{PHPSESSID:""},[s("p",null,"/var/lib/php/sess_")]),s("li",{PHPSESSID:""},[s("p",null,"/tmp/sess_")]),s("li",{PHPSESSID:""},[s("p",null,"/tmp/sessions/sess_")])],-1),f=s("p",null,"PHPSESSID 存放在 Cookie 中：",-1),b=l("",11),$=s("p",null,"此处我直接利用 data:// 执行代码，这比远程文件包含中利用方式便捷太多了，比如下面直接系统命令的示例。",-1),k=l("",15),B=l("",20);function q(D,P,w,S,T,x){const n=e("Image");return t(),c("div",null,[y,p(n,{alt:"图片1.png",src:"https://s0.lgstatic.com/i/image2/M01/0C/3C/Cip5yGAX4A2AGQJLAALnh3QheXo648.png"}),a(),E,p(n,{alt:"图片2.png",src:"https://s0.lgstatic.com/i/image/M00/94/50/CgqCHmAX4CWALTY8AAQPl3E0Ay4160.png"}),a(),i,p(n,{alt:"图片3.png",src:"https://s0.lgstatic.com/i/image/M00/94/50/CgqCHmAX4DSAJYH3AAQINnkRH5s611.png"}),a(),h,p(n,{alt:"图片4.png",src:"https://s0.lgstatic.com/i/image2/M01/0C/3C/Cip5yGAX4EmATdfwAAIXYjl0obE125.png"}),a(),F,d,u,_,g,C,m,p(n,{alt:"图片5.png",src:"https://s0.lgstatic.com/i/image/M00/94/45/Ciqc1GAX4FmADM5PAASEhBTUaiw277.png"}),a(),A,v,f,p(n,{alt:"图片6.png",src:"https://s0.lgstatic.com/i/image/M00/94/50/CgqCHmAX4HOAWgwcAADxpVOzpUc744.png"}),a(),b,p(n,{alt:"图片8.png",src:"https://s0.lgstatic.com/i/image2/M01/0C/3D/Cip5yGAX4KSAapyBAAPVaA5QE1A158.png"}),a(),$,p(n,{alt:"图片7.png",src:"https://s0.lgstatic.com/i/image2/M01/0C/3D/Cip5yGAX4LqAHITdAAFk7HY8mf8051.png"}),a(),k,p(n,{alt:"图片9.png",src:"https://s0.lgstatic.com/i/image/M00/94/51/CgqCHmAX4MqASFfNAAFRLvvVLVE597.png"}),B])}const R=o(r,[["render",q]]);export{I as __pageData,R as default};
