import{_ as p,j as l,o,g as t,k as a,s,h as r,Q as e}from"./chunks/framework.e0c66c3f.js";const k=JSON.parse('{"title":"TraceModuleProvider ","description":"","frontmatter":{},"headers":[],"relativePath":"posts/backEnd/098-讲带你搞懂 SkyWalking文档/(1743) 第25讲：trace-receiver 插件拆解，Trace 蕴含的宝贵信息（上）.md","filePath":"posts/backEnd/098-讲带你搞懂 SkyWalking文档/(1743) 第25讲：trace-receiver 插件拆解，Trace 蕴含的宝贵信息（上）.md","lastUpdated":1696338709000}'),c={name:"posts/backEnd/098-讲带你搞懂 SkyWalking文档/(1743) 第25讲：trace-receiver 插件拆解，Trace 蕴含的宝贵信息（上）.md"},E=s("p",null,"在上一课时中，我介绍了 SkyWalking OAP 处理 Metrics 监控数据的完整流程。本课时将开始介绍 Trace 处理的相关内容。",-1),y=s("h3",{id:"tracemoduleprovider",tabindex:"-1"},[r("TraceModuleProvider "),s("a",{class:"header-anchor",href:"#tracemoduleprovider","aria-label":'Permalink to "TraceModuleProvider"'},"​")],-1),i=s("p",null,"本课时重点内容是来看 OAP 中的 trace-receiver-plugin 如何接收 TraceSegment 数据。",-1),d=s("p",null,"目前 trace-receiver-plugin 插件同时支持处理 V1 和 V2 两个版本的 TraceSegment。本课时重点分析 V2 版本 TraceSegment，后面不进行特殊说明的情况下，都是指 V2 版本 TraceSegment。",-1),g=s("p",null,"在 trace-receiver-plugin 插件的 SPI 文件中指定的 ModuleProvider 实现是 TraceModuleProvider，在 prepare() 方法中主要初始化 SegmentParseV2 解析器，SegmentParseV2 主要负责解析 TraceSegment 数据，具体实现后面会详细分析。",-1),m=s("p",null,"TraceModuleProvider 的 start() 方法核心是将 TraceSegmentReportServiceHandler 注册到 GRPCHandlerRegister 中。TraceSegmentReportServiceHandler 负责接收 Agent 发送来的 TraceSegment 数据，并调用 SegmentParseV2.parse() 方法进行解析，如下图所示：",-1),S=e("",6),u=e("",10),F=e("",17),D=e("",34),v=s("p",null,"如上图所示，RecordPersistentWorker 也继承了 PersistentWorker，写入流程大致如下图所示：",-1),C=e("",6);function A(I,B,h,T,b,f){const n=l("Image");return o(),t("div",null,[E,y,i,d,g,m,a(n,{alt:"Drawing 0.png",src:"https://s0.lgstatic.com/i/image/M00/1B/D7/CgqCHl7fSYGAKb4lAAEg6Xckx78215.png"}),S,a(n,{alt:"Drawing 1.png",src:"https://s0.lgstatic.com/i/image/M00/1B/D7/CgqCHl7fSYqALG1gAAGuE9qIaPk072.png"}),u,a(n,{alt:"Drawing 2.png",src:"https://s0.lgstatic.com/i/image/M00/1B/D7/CgqCHl7fSZuAcM1EAAG3Hx3xP4Y420.png"}),F,a(n,{alt:"Drawing 3.png",src:"https://s0.lgstatic.com/i/image/M00/1B/CC/Ciqc1F7fSaaAbOcSAAApWn6Htjw623.png"}),D,a(n,{alt:"Drawing 4.png",src:"https://s0.lgstatic.com/i/image/M00/1B/D7/CgqCHl7fSbWALRYDAAEn3HDWLfM382.png"}),v,a(n,{alt:"Drawing 5.png",src:"https://s0.lgstatic.com/i/image/M00/1B/CC/Ciqc1F7fSbuAPPvbAAG3YJeCl48222.png"}),C])}const q=p(c,[["render",A]]);export{k as __pageData,q as default};
