import{_ as s,o as n,g as a,Q as p}from"./chunks/framework.e0c66c3f.js";const B=JSON.parse('{"title":"cgroups ","description":"","frontmatter":{},"headers":[],"relativePath":"posts/backEnd/045_由浅入深吃透 Docker/(4581) 10  资源限制：如何通过 Cgroup 机制实现资源限制？.md","filePath":"posts/backEnd/045_由浅入深吃透 Docker/(4581) 10  资源限制：如何通过 Cgroup 机制实现资源限制？.md","lastUpdated":1696338709000}'),o={name:"posts/backEnd/045_由浅入深吃透 Docker/(4581) 10  资源限制：如何通过 Cgroup 机制实现资源限制？.md"},l=p(`<p>上一课时，我们知道使用不同的 Namespace，可以实现容器中的进程看不到别的容器的资源，但是有一个问题你是否注意到？容器内的进程仍然可以任意地使用主机的 CPU 、内存等资源，如果某一个容器使用的主机资源过多，可能导致主机的资源竞争，进而影响业务。那如果我们想限制一个容器资源的使用（如 CPU、内存等）应该如何做呢？</p><p>这里就需要用到 Linux 内核的另一个核心技术cgroups。那么究竟什么是cgroups？我们应该如何使用cgroups？Docker 又是如何使用cgroups的？下面我带你一一解密。</p><p>首先我们来学习下什么是cgroups。</p><h3 id="cgroups" tabindex="-1">cgroups <a class="header-anchor" href="#cgroups" aria-label="Permalink to &quot;cgroups&quot;">​</a></h3><p>cgroups（全称：control groups）是 Linux 内核的一个功能，它可以实现限制进程或者进程组的资源（如 CPU、内存、磁盘 IO 等）。</p><blockquote><p>在 2006 年，Google 的工程师（ Rohit Seth 和 Paul Menage 为主要发起人） 发起了这个项目，起初项目名称并不是cgroups，而被称为进程容器（process containers）。在 2007 年cgroups代码计划合入Linux 内核，但是当时在 Linux 内核中，容器（container）这个词被广泛使用，并且拥有不同的含义。为了避免命名混乱和歧义，进程容器被重名为cgroups，并在 2008 年成功合入 Linux 2.6.24 版本中。cgroups目前已经成为 systemd、Docker、Linux Containers（LXC） 等技术的基础。</p></blockquote><h4 id="cgroups-功能及核心概念" tabindex="-1">cgroups 功能及核心概念 <a class="header-anchor" href="#cgroups-功能及核心概念" aria-label="Permalink to &quot;cgroups 功能及核心概念&quot;">​</a></h4><p>cgroups 主要提供了如下功能。</p><ul><li><p>资源限制： 限制资源的使用量，例如我们可以通过限制某个业务的内存上限，从而保护主机其他业务的安全运行。</p></li><li><p>优先级控制：不同的组可以有不同的资源（ CPU 、磁盘 IO 等）使用优先级。</p></li><li><p>审计：计算控制组的资源使用情况。</p></li><li><p>控制：控制进程的挂起或恢复。</p></li></ul><p>了解了 cgroups 可以为我们提供什么功能，下面我来看下 cgroups 是如何实现这些功能的。</p><p>cgroups功能的实现依赖于三个核心概念：子系统、控制组、层级树。</p><ul><li><p>子系统（subsystem）：是一个内核的组件，一个子系统代表一类资源调度控制器。例如内存子系统可以限制内存的使用量，CPU 子系统可以限制 CPU 的使用时间。</p></li><li><p>控制组（cgroup）：表示一组进程和一组带有参数的子系统的关联关系。例如，一个进程使用了 CPU 子系统来限制 CPU 的使用时间，则这个进程和 CPU 子系统的关联关系称为控制组。</p></li><li><p>层级树（hierarchy）：是由一系列的控制组按照树状结构排列组成的。这种排列方式可以使得控制组拥有父子关系，子控制组默认拥有父控制组的属性，也就是子控制组会继承于父控制组。比如，系统中定义了一个控制组 c1，限制了 CPU 可以使用 1 核，然后另外一个控制组 c2 想实现既限制 CPU 使用 1 核，同时限制内存使用 2G，那么 c2 就可以直接继承 c1，无须重复定义 CPU 限制。</p></li></ul><p>cgroups 的三个核心概念中，子系统是最核心的概念，因为子系统是真正实现某类资源的限制的基础。</p><h3 id="cgroups-子系统实例" tabindex="-1">cgroups 子系统实例 <a class="header-anchor" href="#cgroups-子系统实例" aria-label="Permalink to &quot;cgroups 子系统实例&quot;">​</a></h3><p>下面我通过一个实例演示一下在 Linux 上默认都启动了哪些子系统。</p><p>我们先通过 mount 命令查看一下当前系统已经挂载的cgroups信息：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">mount</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-t</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup</span></span>
<span class="line"><span style="color:#B392F0;">cgroup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">on</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/sys/fs/cgroup/systemd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup</span><span style="color:#E1E4E8;"> (rw,nosuid,nodev,noexec,relatime,seclabel,xattr,release_agent=/usr/lib/systemd/systemd-cgroups-agent,name=systemd)</span></span>
<span class="line"><span style="color:#B392F0;">cgroup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">on</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/sys/fs/cgroup/net_cls,net_prio</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup</span><span style="color:#E1E4E8;"> (rw,nosuid,nodev,noexec,relatime,seclabel,net_prio,net_cls)</span></span>
<span class="line"><span style="color:#B392F0;">cgroup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">on</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/sys/fs/cgroup/blkio</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup</span><span style="color:#E1E4E8;"> (rw,nosuid,nodev,noexec,relatime,seclabel,blkio)</span></span>
<span class="line"><span style="color:#B392F0;">cgroup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">on</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/sys/fs/cgroup/pids</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup</span><span style="color:#E1E4E8;"> (rw,nosuid,nodev,noexec,relatime,seclabel,pids)</span></span>
<span class="line"><span style="color:#B392F0;">cgroup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">on</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/sys/fs/cgroup/cpu,cpuacct</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup</span><span style="color:#E1E4E8;"> (rw,nosuid,nodev,noexec,relatime,seclabel,cpuacct,cpu)</span></span>
<span class="line"><span style="color:#B392F0;">cgroup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">on</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/sys/fs/cgroup/perf_event</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup</span><span style="color:#E1E4E8;"> (rw,nosuid,nodev,noexec,relatime,seclabel,perf_event)</span></span>
<span class="line"><span style="color:#B392F0;">cgroup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">on</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/sys/fs/cgroup/freezer</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup</span><span style="color:#E1E4E8;"> (rw,nosuid,nodev,noexec,relatime,seclabel,freezer)</span></span>
<span class="line"><span style="color:#B392F0;">cgroup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">on</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/sys/fs/cgroup/devices</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup</span><span style="color:#E1E4E8;"> (rw,nosuid,nodev,noexec,relatime,seclabel,devices)</span></span>
<span class="line"><span style="color:#B392F0;">cgroup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">on</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/sys/fs/cgroup/memory</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup</span><span style="color:#E1E4E8;"> (rw,nosuid,nodev,noexec,relatime,seclabel,memory)</span></span>
<span class="line"><span style="color:#B392F0;">cgroup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">on</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/sys/fs/cgroup/cpuset</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup</span><span style="color:#E1E4E8;"> (rw,nosuid,nodev,noexec,relatime,seclabel,cpuset)</span></span>
<span class="line"><span style="color:#B392F0;">cgroup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">on</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/sys/fs/cgroup/hugetlb</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">type</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup</span><span style="color:#E1E4E8;"> (rw,nosuid,nodev,noexec,relatime,seclabel,hugetlb)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">mount</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-t</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup</span></span>
<span class="line"><span style="color:#6F42C1;">cgroup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">on</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/sys/fs/cgroup/systemd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">type</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup</span><span style="color:#24292E;"> (rw,nosuid,nodev,noexec,relatime,seclabel,xattr,release_agent=/usr/lib/systemd/systemd-cgroups-agent,name=systemd)</span></span>
<span class="line"><span style="color:#6F42C1;">cgroup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">on</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/sys/fs/cgroup/net_cls,net_prio</span><span style="color:#24292E;"> </span><span style="color:#032F62;">type</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup</span><span style="color:#24292E;"> (rw,nosuid,nodev,noexec,relatime,seclabel,net_prio,net_cls)</span></span>
<span class="line"><span style="color:#6F42C1;">cgroup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">on</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/sys/fs/cgroup/blkio</span><span style="color:#24292E;"> </span><span style="color:#032F62;">type</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup</span><span style="color:#24292E;"> (rw,nosuid,nodev,noexec,relatime,seclabel,blkio)</span></span>
<span class="line"><span style="color:#6F42C1;">cgroup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">on</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/sys/fs/cgroup/pids</span><span style="color:#24292E;"> </span><span style="color:#032F62;">type</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup</span><span style="color:#24292E;"> (rw,nosuid,nodev,noexec,relatime,seclabel,pids)</span></span>
<span class="line"><span style="color:#6F42C1;">cgroup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">on</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/sys/fs/cgroup/cpu,cpuacct</span><span style="color:#24292E;"> </span><span style="color:#032F62;">type</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup</span><span style="color:#24292E;"> (rw,nosuid,nodev,noexec,relatime,seclabel,cpuacct,cpu)</span></span>
<span class="line"><span style="color:#6F42C1;">cgroup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">on</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/sys/fs/cgroup/perf_event</span><span style="color:#24292E;"> </span><span style="color:#032F62;">type</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup</span><span style="color:#24292E;"> (rw,nosuid,nodev,noexec,relatime,seclabel,perf_event)</span></span>
<span class="line"><span style="color:#6F42C1;">cgroup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">on</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/sys/fs/cgroup/freezer</span><span style="color:#24292E;"> </span><span style="color:#032F62;">type</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup</span><span style="color:#24292E;"> (rw,nosuid,nodev,noexec,relatime,seclabel,freezer)</span></span>
<span class="line"><span style="color:#6F42C1;">cgroup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">on</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/sys/fs/cgroup/devices</span><span style="color:#24292E;"> </span><span style="color:#032F62;">type</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup</span><span style="color:#24292E;"> (rw,nosuid,nodev,noexec,relatime,seclabel,devices)</span></span>
<span class="line"><span style="color:#6F42C1;">cgroup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">on</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/sys/fs/cgroup/memory</span><span style="color:#24292E;"> </span><span style="color:#032F62;">type</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup</span><span style="color:#24292E;"> (rw,nosuid,nodev,noexec,relatime,seclabel,memory)</span></span>
<span class="line"><span style="color:#6F42C1;">cgroup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">on</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/sys/fs/cgroup/cpuset</span><span style="color:#24292E;"> </span><span style="color:#032F62;">type</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup</span><span style="color:#24292E;"> (rw,nosuid,nodev,noexec,relatime,seclabel,cpuset)</span></span>
<span class="line"><span style="color:#6F42C1;">cgroup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">on</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/sys/fs/cgroup/hugetlb</span><span style="color:#24292E;"> </span><span style="color:#032F62;">type</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup</span><span style="color:#24292E;"> (rw,nosuid,nodev,noexec,relatime,seclabel,hugetlb)</span></span></code></pre></div><blockquote><p>我的操作系统版本为 CentOS7.8，内核为 3.10.0-1127.el7.x86_64 版本，不同内核版本cgroups子系统和使用方式可能略有差异。如果你对cgroups不是很熟悉，请尽量使用与我相同的内核环境操作。</p></blockquote><p>通过输出，可以看到当前系统已经挂载了我们常用的cgroups子系统，例如 cpu、memory、pids 等我们常用的cgroups子系统。这些子系统中，cpu 和 memory 子系统是容器环境中使用最多的子系统，下面我对这两个子系统做详细介绍。</p><h4 id="cpu-子系统" tabindex="-1">cpu 子系统 <a class="header-anchor" href="#cpu-子系统" aria-label="Permalink to &quot;cpu 子系统&quot;">​</a></h4><p>我首先以 cpu 子系统为例，演示一下cgroups如何限制进程的 cpu 使用时间。由于cgroups的操作很多需要用到 root 权限，我们在执行命令前要确保已经切换到了 root 用户，以下命令的执行默认都是使用 root 用户。</p><p><strong>第一步：在 cpu 子系统下创建 cgroup</strong></p><p>cgroups的创建很简单，只需要在相应的子系统下创建目录即可。下面我们到 cpu 子系统下创建测试文件夹：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># mkdir /sys/fs/cgroup/cpu/mydocker</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># mkdir /sys/fs/cgroup/cpu/mydocker</span></span></code></pre></div><p>执行完上述命令后，我们查看一下我们新创建的目录下发生了什么？</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># ls -l /sys/fs/cgroup/cpu/mydocker</span></span>
<span class="line"><span style="color:#B392F0;">total</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#B392F0;">-rw-r--r--.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">09</span><span style="color:#9ECBFF;">:19</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup.clone_children</span></span>
<span class="line"><span style="color:#B392F0;">--w--w--w-.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">09</span><span style="color:#9ECBFF;">:19</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup.event_control</span></span>
<span class="line"><span style="color:#B392F0;">-rw-r--r--.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">09</span><span style="color:#9ECBFF;">:19</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup.procs</span></span>
<span class="line"><span style="color:#B392F0;">-rw-r--r--.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">09</span><span style="color:#9ECBFF;">:19</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cpu.cfs_period_us</span></span>
<span class="line"><span style="color:#B392F0;">-rw-r--r--.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">09</span><span style="color:#9ECBFF;">:19</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cpu.cfs_quota_us</span></span>
<span class="line"><span style="color:#B392F0;">-rw-r--r--.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">09</span><span style="color:#9ECBFF;">:19</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cpu.rt_period_us</span></span>
<span class="line"><span style="color:#B392F0;">-rw-r--r--.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">09</span><span style="color:#9ECBFF;">:19</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cpu.rt_runtime_us</span></span>
<span class="line"><span style="color:#B392F0;">-rw-r--r--.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">09</span><span style="color:#9ECBFF;">:19</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cpu.shares</span></span>
<span class="line"><span style="color:#B392F0;">-r--r--r--.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">09</span><span style="color:#9ECBFF;">:19</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cpu.stat</span></span>
<span class="line"><span style="color:#B392F0;">-r--r--r--.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">09</span><span style="color:#9ECBFF;">:19</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cpuacct.stat</span></span>
<span class="line"><span style="color:#B392F0;">-rw-r--r--.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">09</span><span style="color:#9ECBFF;">:19</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cpuacct.usage</span></span>
<span class="line"><span style="color:#B392F0;">-r--r--r--.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">09</span><span style="color:#9ECBFF;">:19</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cpuacct.usage_percpu</span></span>
<span class="line"><span style="color:#B392F0;">-rw-r--r--.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">09</span><span style="color:#9ECBFF;">:19</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">notify_on_release</span></span>
<span class="line"><span style="color:#B392F0;">-rw-r--r--.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">09</span><span style="color:#9ECBFF;">:19</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tasks</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># ls -l /sys/fs/cgroup/cpu/mydocker</span></span>
<span class="line"><span style="color:#6F42C1;">total</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#6F42C1;">-rw-r--r--.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">09</span><span style="color:#032F62;">:19</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup.clone_children</span></span>
<span class="line"><span style="color:#6F42C1;">--w--w--w-.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">09</span><span style="color:#032F62;">:19</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup.event_control</span></span>
<span class="line"><span style="color:#6F42C1;">-rw-r--r--.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">09</span><span style="color:#032F62;">:19</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup.procs</span></span>
<span class="line"><span style="color:#6F42C1;">-rw-r--r--.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">09</span><span style="color:#032F62;">:19</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cpu.cfs_period_us</span></span>
<span class="line"><span style="color:#6F42C1;">-rw-r--r--.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">09</span><span style="color:#032F62;">:19</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cpu.cfs_quota_us</span></span>
<span class="line"><span style="color:#6F42C1;">-rw-r--r--.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">09</span><span style="color:#032F62;">:19</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cpu.rt_period_us</span></span>
<span class="line"><span style="color:#6F42C1;">-rw-r--r--.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">09</span><span style="color:#032F62;">:19</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cpu.rt_runtime_us</span></span>
<span class="line"><span style="color:#6F42C1;">-rw-r--r--.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">09</span><span style="color:#032F62;">:19</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cpu.shares</span></span>
<span class="line"><span style="color:#6F42C1;">-r--r--r--.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">09</span><span style="color:#032F62;">:19</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cpu.stat</span></span>
<span class="line"><span style="color:#6F42C1;">-r--r--r--.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">09</span><span style="color:#032F62;">:19</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cpuacct.stat</span></span>
<span class="line"><span style="color:#6F42C1;">-rw-r--r--.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">09</span><span style="color:#032F62;">:19</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cpuacct.usage</span></span>
<span class="line"><span style="color:#6F42C1;">-r--r--r--.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">09</span><span style="color:#032F62;">:19</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cpuacct.usage_percpu</span></span>
<span class="line"><span style="color:#6F42C1;">-rw-r--r--.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">09</span><span style="color:#032F62;">:19</span><span style="color:#24292E;"> </span><span style="color:#032F62;">notify_on_release</span></span>
<span class="line"><span style="color:#6F42C1;">-rw-r--r--.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">09</span><span style="color:#032F62;">:19</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tasks</span></span></code></pre></div><p>由上可以看到我们新建的目录下被自动创建了很多文件，其中 cpu.cfs_quota_us 文件代表在某一个阶段限制的 CPU 时间总量，单位为微秒。例如，我们想限制某个进程最多使用 1 核 CPU，就在这个文件里写入 100000（100000 代表限制 1 个核） ，tasks 文件中写入进程的 ID 即可（如果要限制多个进程 ID，在 tasks 文件中用换行符分隔即可）。</p><p>此时，我们所需要的 cgroup 就创建好了。对，就是这么简单。</p><p><strong>第二步：创建进程，加入 cgroup</strong></p><p>这里为了方便演示，我先把当前运行的 shell 进程加入 cgroup，然后在当前 shell 运行 cpu 耗时任务（这里利用到了继承，子进程会继承父进程的 cgroup）。</p><p>使用以下命令将 shell 进程加入 cgroup 中：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># cd /sys/fs/cgroup/cpu/mydocker</span></span>
<span class="line"><span style="color:#6A737D;"># echo $$ &gt; tasks</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># cd /sys/fs/cgroup/cpu/mydocker</span></span>
<span class="line"><span style="color:#6A737D;"># echo $$ &gt; tasks</span></span></code></pre></div><p>查看一下 tasks 文件内容：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># cat tasks</span></span>
<span class="line"><span style="color:#B392F0;">3485</span></span>
<span class="line"><span style="color:#B392F0;">3543</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># cat tasks</span></span>
<span class="line"><span style="color:#6F42C1;">3485</span></span>
<span class="line"><span style="color:#6F42C1;">3543</span></span></code></pre></div><p>其中第一个进程 ID 为当前 shell 的主进程，也就是说，当前 shell 主进程为 3485。</p><p><strong>第三步：执行 CPU 耗时任务，验证 cgroup 是否可以限制 cpu 使用时间</strong></p><p>下面，我们使用以下命令制造一个死循环，来提升 cpu 使用率：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># while true;do echo;done;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># while true;do echo;done;</span></span></code></pre></div><p>执行完上述命令后，我们新打开一个 shell 窗口，使用 top -p 命令查看当前 cpu 使用率，-p 参数后面跟进程 ID，我这里是 3485。</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">top</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3485</span></span>
<span class="line"><span style="color:#B392F0;">top</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">09</span><span style="color:#9ECBFF;">:51:35</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">up</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">days,</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">22</span><span style="color:#9ECBFF;">:00,</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">users,</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">load</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">average:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1.59</span><span style="color:#9ECBFF;">,</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.58</span><span style="color:#9ECBFF;">,</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.27</span></span>
<span class="line"><span style="color:#B392F0;">Tasks:</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">total,</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">running,</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sleeping,</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">stopped,</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zombie</span></span>
<span class="line"><span style="color:#B392F0;">%Cpu(s</span><span style="color:#E1E4E8;">):  9.7 us,  2.8 sy,  0.0 ni, 87.4 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span></span>
<span class="line"><span style="color:#B392F0;">KiB</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Mem</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">32779616</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">total,</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">31009780</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">free,</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">495988</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">used,</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1273848</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">buff/cache</span></span>
<span class="line"><span style="color:#B392F0;">KiB</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Swap:</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">total,</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">free,</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">used.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">31852336</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">avail</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Mem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">PID</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">USER</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">PR</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">NI</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">VIRT</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">RES</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">SHR</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">S</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">%CPU</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">%MEM</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">TIME+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">COMMAND</span></span>
<span class="line"><span style="color:#B392F0;">3485</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">116336</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">2852</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1688</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">S</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">99.7</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">0.0</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">2</span><span style="color:#9ECBFF;">:10.71</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">bash</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">top</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3485</span></span>
<span class="line"><span style="color:#6F42C1;">top</span><span style="color:#24292E;"> </span><span style="color:#032F62;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">09</span><span style="color:#032F62;">:51:35</span><span style="color:#24292E;"> </span><span style="color:#032F62;">up</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> </span><span style="color:#032F62;">days,</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">22</span><span style="color:#032F62;">:00,</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;"> </span><span style="color:#032F62;">users,</span><span style="color:#24292E;">  </span><span style="color:#032F62;">load</span><span style="color:#24292E;"> </span><span style="color:#032F62;">average:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1.59</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.58</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.27</span></span>
<span class="line"><span style="color:#6F42C1;">Tasks:</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">total,</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">running,</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sleeping,</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">stopped,</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zombie</span></span>
<span class="line"><span style="color:#6F42C1;">%Cpu(s</span><span style="color:#24292E;">):  9.7 us,  2.8 sy,  0.0 ni, 87.4 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span></span>
<span class="line"><span style="color:#6F42C1;">KiB</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Mem</span><span style="color:#24292E;"> </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">32779616</span><span style="color:#24292E;"> </span><span style="color:#032F62;">total,</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">31009780</span><span style="color:#24292E;"> </span><span style="color:#032F62;">free,</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">495988</span><span style="color:#24292E;"> </span><span style="color:#032F62;">used,</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1273848</span><span style="color:#24292E;"> </span><span style="color:#032F62;">buff/cache</span></span>
<span class="line"><span style="color:#6F42C1;">KiB</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Swap:</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">total,</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">free,</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">used.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">31852336</span><span style="color:#24292E;"> </span><span style="color:#032F62;">avail</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Mem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">PID</span><span style="color:#24292E;"> </span><span style="color:#032F62;">USER</span><span style="color:#24292E;">      </span><span style="color:#032F62;">PR</span><span style="color:#24292E;">  </span><span style="color:#032F62;">NI</span><span style="color:#24292E;">    </span><span style="color:#032F62;">VIRT</span><span style="color:#24292E;">    </span><span style="color:#032F62;">RES</span><span style="color:#24292E;">    </span><span style="color:#032F62;">SHR</span><span style="color:#24292E;"> </span><span style="color:#032F62;">S</span><span style="color:#24292E;">  </span><span style="color:#032F62;">%CPU</span><span style="color:#24292E;"> </span><span style="color:#032F62;">%MEM</span><span style="color:#24292E;">     </span><span style="color:#032F62;">TIME+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">COMMAND</span></span>
<span class="line"><span style="color:#6F42C1;">3485</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">20</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">116336</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">2852</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1688</span><span style="color:#24292E;"> </span><span style="color:#032F62;">S</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">99.7</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">0.0</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">:10.71</span><span style="color:#24292E;"> </span><span style="color:#032F62;">bash</span></span></code></pre></div><p>通过上面输出可以看到 3485 这个进程被限制到了只能使用 100 % 的 cpu，也就是 1 个核。说明我们使用 cgroup 来限制 cpu 使用时间已经生效。此时，执行 while 循环的命令行窗口可以使用 Ctrl+c 退出循环。</p><p>为了进一步证实 cgroup 限制 cpu 的准确性，我们修改 cpu 限制时间为 0.5 核，命令如下：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># cd /sys/fs/cgroup/cpu/mydocker</span></span>
<span class="line"><span style="color:#6A737D;"># echo 50000 &gt; cpu.cfs_quota_us</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># cd /sys/fs/cgroup/cpu/mydocker</span></span>
<span class="line"><span style="color:#6A737D;"># echo 50000 &gt; cpu.cfs_quota_us</span></span></code></pre></div><p>同样使用上面的命令来制造死循环：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># while true;do echo;done;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># while true;do echo;done;</span></span></code></pre></div><p>保持当前窗口，新打开一个 shell 窗口，使用 top -p 参数查看 cpu 使用率：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">top</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3485</span></span>
<span class="line"><span style="color:#B392F0;">top</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">:05:25</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">up</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">days,</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">22</span><span style="color:#9ECBFF;">:14,</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">users,</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">load</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">average:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1.02</span><span style="color:#9ECBFF;">,</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.43</span><span style="color:#9ECBFF;">,</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.40</span></span>
<span class="line"><span style="color:#B392F0;">Tasks:</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">total,</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">running,</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sleeping,</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">stopped,</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zombie</span></span>
<span class="line"><span style="color:#B392F0;">%Cpu(s</span><span style="color:#E1E4E8;">):  5.0 us,  1.3 sy,  0.0 ni, 93.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span></span>
<span class="line"><span style="color:#B392F0;">KiB</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Mem</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">32779616</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">total,</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">31055676</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">free,</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">450224</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">used,</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1273716</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">buff/cache</span></span>
<span class="line"><span style="color:#B392F0;">KiB</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Swap:</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">total,</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">free,</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">used.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">31898216</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">avail</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Mem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">PID</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">USER</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">PR</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">NI</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">VIRT</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">RES</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">SHR</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">S</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">%CPU</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">%MEM</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">TIME+</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">COMMAND</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">3485</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">115544</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">2116</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1664</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">R</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">50.0</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">0.0</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#9ECBFF;">:23.39</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">bash</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">top</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3485</span></span>
<span class="line"><span style="color:#6F42C1;">top</span><span style="color:#24292E;"> </span><span style="color:#032F62;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#032F62;">:05:25</span><span style="color:#24292E;"> </span><span style="color:#032F62;">up</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> </span><span style="color:#032F62;">days,</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">22</span><span style="color:#032F62;">:14,</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> </span><span style="color:#032F62;">users,</span><span style="color:#24292E;">  </span><span style="color:#032F62;">load</span><span style="color:#24292E;"> </span><span style="color:#032F62;">average:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1.02</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.43</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.40</span></span>
<span class="line"><span style="color:#6F42C1;">Tasks:</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">total,</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">running,</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sleeping,</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">stopped,</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zombie</span></span>
<span class="line"><span style="color:#6F42C1;">%Cpu(s</span><span style="color:#24292E;">):  5.0 us,  1.3 sy,  0.0 ni, 93.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span></span>
<span class="line"><span style="color:#6F42C1;">KiB</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Mem</span><span style="color:#24292E;"> </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">32779616</span><span style="color:#24292E;"> </span><span style="color:#032F62;">total,</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">31055676</span><span style="color:#24292E;"> </span><span style="color:#032F62;">free,</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">450224</span><span style="color:#24292E;"> </span><span style="color:#032F62;">used,</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1273716</span><span style="color:#24292E;"> </span><span style="color:#032F62;">buff/cache</span></span>
<span class="line"><span style="color:#6F42C1;">KiB</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Swap:</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">total,</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">free,</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">used.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">31898216</span><span style="color:#24292E;"> </span><span style="color:#032F62;">avail</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Mem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">PID</span><span style="color:#24292E;"> </span><span style="color:#032F62;">USER</span><span style="color:#24292E;">      </span><span style="color:#032F62;">PR</span><span style="color:#24292E;">  </span><span style="color:#032F62;">NI</span><span style="color:#24292E;">    </span><span style="color:#032F62;">VIRT</span><span style="color:#24292E;">    </span><span style="color:#032F62;">RES</span><span style="color:#24292E;">    </span><span style="color:#032F62;">SHR</span><span style="color:#24292E;"> </span><span style="color:#032F62;">S</span><span style="color:#24292E;">  </span><span style="color:#032F62;">%CPU</span><span style="color:#24292E;"> </span><span style="color:#032F62;">%MEM</span><span style="color:#24292E;">     </span><span style="color:#032F62;">TIME+</span><span style="color:#24292E;"> </span><span style="color:#032F62;">COMMAND</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#6F42C1;">3485</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">20</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">115544</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">2116</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1664</span><span style="color:#24292E;"> </span><span style="color:#032F62;">R</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">50.0</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">0.0</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">:23.39</span><span style="color:#24292E;"> </span><span style="color:#032F62;">bash</span></span></code></pre></div><p>通过上面输出可以看到，此时 cpu 使用率已经被限制到了 50%，即 0.5 个核。</p><p>验证完 cgroup 限制 cpu，我们使用相似的方法来验证 cgroup 对内存的限制。</p><h4 id="memroy-子系统" tabindex="-1">memroy 子系统 <a class="header-anchor" href="#memroy-子系统" aria-label="Permalink to &quot;memroy 子系统&quot;">​</a></h4><p><strong>第一步：在 memory 子系统下创建 cgroup</strong></p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># mkdir /sys/fs/cgroup/memory/mydocker</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># mkdir /sys/fs/cgroup/memory/mydocker</span></span></code></pre></div><p>同样，我们查看一下新创建的目录下发生了什么？</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">total </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> cgroup.clone_children</span></span>
<span class="line"><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">w</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">w</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">w</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> cgroup.event_control</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> cgroup.procs</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.failcnt</span></span>
<span class="line"><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">w</span><span style="color:#F97583;">-------</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.force_empty</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.kmem.failcnt</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.kmem.limit_in_bytes</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.kmem.max_usage_in_bytes</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.kmem.slabinfo</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.kmem.tcp.failcnt</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.kmem.tcp.limit_in_bytes</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.kmem.tcp.max_usage_in_bytes</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.kmem.tcp.usage_in_bytes</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.kmem.usage_in_bytes</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.limit_in_bytes</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.max_usage_in_bytes</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.memsw.failcnt</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.memsw.limit_in_bytes</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.memsw.max_usage_in_bytes</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.memsw.usage_in_bytes</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.move_charge_at_immigrate</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.numa_stat</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.oom_control</span></span>
<span class="line"><span style="color:#F97583;">----------</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.pressure_level</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.soft_limit_in_bytes</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.stat</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.swappiness</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.usage_in_bytes</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> memory.use_hierarchy</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> notify_on_release</span></span>
<span class="line"><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">rw</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">. </span><span style="color:#FDAEB7;font-style:italic;">1</span><span style="color:#E1E4E8;"> root root </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> Sep  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#F97583;">:</span><span style="color:#79B8FF;">18</span><span style="color:#E1E4E8;"> tasks</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">total </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> cgroup.clone_children</span></span>
<span class="line"><span style="color:#D73A49;">--</span><span style="color:#24292E;">w</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">w</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">w</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> cgroup.event_control</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> cgroup.procs</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.failcnt</span></span>
<span class="line"><span style="color:#D73A49;">--</span><span style="color:#24292E;">w</span><span style="color:#D73A49;">-------</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.force_empty</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.kmem.failcnt</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.kmem.limit_in_bytes</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.kmem.max_usage_in_bytes</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.kmem.slabinfo</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.kmem.tcp.failcnt</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.kmem.tcp.limit_in_bytes</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.kmem.tcp.max_usage_in_bytes</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.kmem.tcp.usage_in_bytes</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.kmem.usage_in_bytes</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.limit_in_bytes</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.max_usage_in_bytes</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.memsw.failcnt</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.memsw.limit_in_bytes</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.memsw.max_usage_in_bytes</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.memsw.usage_in_bytes</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.move_charge_at_immigrate</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.numa_stat</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.oom_control</span></span>
<span class="line"><span style="color:#D73A49;">----------</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.pressure_level</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.soft_limit_in_bytes</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.stat</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.swappiness</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.usage_in_bytes</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> memory.use_hierarchy</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> notify_on_release</span></span>
<span class="line"><span style="color:#D73A49;">-</span><span style="color:#24292E;">rw</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">--</span><span style="color:#24292E;">. </span><span style="color:#B31D28;font-style:italic;">1</span><span style="color:#24292E;"> root root </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> Sep  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;">18</span><span style="color:#24292E;"> tasks</span></span></code></pre></div><p>其中 memory.limit_in_bytes 文件代表内存使用总量，单位为 byte。</p><p>例如，这里我希望对内存使用限制为 1G，则向 memory.limit_in_bytes 文件写入 1073741824，命令如下：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># cd /sys/fs/cgroup/memory/mydocker</span></span>
<span class="line"><span style="color:#6A737D;"># echo 1073741824 &gt; memory.limit_in_bytes</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># cd /sys/fs/cgroup/memory/mydocker</span></span>
<span class="line"><span style="color:#6A737D;"># echo 1073741824 &gt; memory.limit_in_bytes</span></span></code></pre></div><p><strong>第二步：创建进程，加入 cgroup</strong></p><p>同样把当前 shell 进程 ID 写入 tasks 文件内：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># cd /sys/fs/cgroup/memory/mydocker</span></span>
<span class="line"><span style="color:#6A737D;"># echo $$ &gt; tasks</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># cd /sys/fs/cgroup/memory/mydocker</span></span>
<span class="line"><span style="color:#6A737D;"># echo $$ &gt; tasks</span></span></code></pre></div><p><strong>第三步，执行内存测试工具，申请内存</strong></p><p>这里我们需要借助一下工具 memtester，memtester 的安装这里不再详细介绍了。具体安装方式可以参考<a href="https://wilhelmguo.cn/blog/post/william/CentOS7-%E5%AE%89%E8%A3%85%E5%86%85%E5%AD%98%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7-memtester" target="_blank" rel="noreferrer">这里</a>。</p><p>安装好 memtester 后，我们执行以下命令：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># memtester 1500M 1</span></span>
<span class="line"><span style="color:#B392F0;">memtester</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">version</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">4.2</span><span style="color:#9ECBFF;">.2</span><span style="color:#E1E4E8;"> (64-bit)</span></span>
<span class="line"><span style="color:#B392F0;">Copyright</span><span style="color:#E1E4E8;"> (C) 2010 Charles Cazabon.</span></span>
<span class="line"><span style="color:#B392F0;">Licensed</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">under</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">the</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">GNU</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">General</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Public</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">License</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">version</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> (only).</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">pagesize</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">is</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">4096</span></span>
<span class="line"><span style="color:#B392F0;">pagesizemask</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">is</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0xfffffffffffff000</span></span>
<span class="line"><span style="color:#B392F0;">want</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1500</span><span style="color:#9ECBFF;">MB</span><span style="color:#E1E4E8;"> (1572864000 </span><span style="color:#9ECBFF;">bytes</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#B392F0;">got</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1500</span><span style="color:#9ECBFF;">MB</span><span style="color:#E1E4E8;"> (1572864000 </span><span style="color:#9ECBFF;">bytes</span><span style="color:#E1E4E8;">), trying mlock ...Killed</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># memtester 1500M 1</span></span>
<span class="line"><span style="color:#6F42C1;">memtester</span><span style="color:#24292E;"> </span><span style="color:#032F62;">version</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">4.2</span><span style="color:#032F62;">.2</span><span style="color:#24292E;"> (64-bit)</span></span>
<span class="line"><span style="color:#6F42C1;">Copyright</span><span style="color:#24292E;"> (C) 2010 Charles Cazabon.</span></span>
<span class="line"><span style="color:#6F42C1;">Licensed</span><span style="color:#24292E;"> </span><span style="color:#032F62;">under</span><span style="color:#24292E;"> </span><span style="color:#032F62;">the</span><span style="color:#24292E;"> </span><span style="color:#032F62;">GNU</span><span style="color:#24292E;"> </span><span style="color:#032F62;">General</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Public</span><span style="color:#24292E;"> </span><span style="color:#032F62;">License</span><span style="color:#24292E;"> </span><span style="color:#032F62;">version</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> (only).</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">pagesize</span><span style="color:#24292E;"> </span><span style="color:#032F62;">is</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">4096</span></span>
<span class="line"><span style="color:#6F42C1;">pagesizemask</span><span style="color:#24292E;"> </span><span style="color:#032F62;">is</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0xfffffffffffff000</span></span>
<span class="line"><span style="color:#6F42C1;">want</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1500</span><span style="color:#032F62;">MB</span><span style="color:#24292E;"> (1572864000 </span><span style="color:#032F62;">bytes</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#6F42C1;">got</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1500</span><span style="color:#032F62;">MB</span><span style="color:#24292E;"> (1572864000 </span><span style="color:#032F62;">bytes</span><span style="color:#24292E;">), trying mlock ...Killed</span></span></code></pre></div><p>该命令会申请 1500 M 内存，并且做内存测试。由于上面我们对当前 shell 进程内存限制为 1 G，当 memtester 使用的内存达到 1G 时，cgroup 便将 memtester 杀死。</p><p>上面最后一行的输出结果表示 memtester 想要 1500 M 内存，但是由于 cgroup 限制，达到了内存使用上限，被杀死了，与我们的预期一致。</p><p>我们可以使用以下命令，降低一下内存申请，将内存申请调整为 500M：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># memtester 500M 1</span></span>
<span class="line"><span style="color:#B392F0;">memtester</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">version</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">4.2</span><span style="color:#9ECBFF;">.2</span><span style="color:#E1E4E8;"> (64-bit)</span></span>
<span class="line"><span style="color:#B392F0;">Copyright</span><span style="color:#E1E4E8;"> (C) 2010 Charles Cazabon.</span></span>
<span class="line"><span style="color:#B392F0;">Licensed</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">under</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">the</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">GNU</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">General</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Public</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">License</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">version</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> (only).</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">pagesize</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">is</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">4096</span></span>
<span class="line"><span style="color:#B392F0;">pagesizemask</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">is</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0xfffffffffffff000</span></span>
<span class="line"><span style="color:#B392F0;">want</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">500</span><span style="color:#9ECBFF;">MB</span><span style="color:#E1E4E8;"> (524288000 </span><span style="color:#9ECBFF;">bytes</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#B392F0;">got</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">500</span><span style="color:#9ECBFF;">MB</span><span style="color:#E1E4E8;"> (524288000 </span><span style="color:#9ECBFF;">bytes</span><span style="color:#E1E4E8;">), trying mlock ...locked.</span></span>
<span class="line"><span style="color:#B392F0;">Loop</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Stuck</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Address</span><span style="color:#E1E4E8;">       </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Random</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Value</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Compare</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">XOR</span><span style="color:#E1E4E8;">         </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Compare</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SUB</span><span style="color:#E1E4E8;">         </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Compare</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">MUL</span><span style="color:#E1E4E8;">         </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Compare</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">DIV</span><span style="color:#E1E4E8;">         </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Compare</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">OR</span><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Compare</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">AND</span><span style="color:#E1E4E8;">         </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Sequential</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Increment:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Solid</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Bits</span><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Block</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sequential</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Checkerboard</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Bit</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Spread</span><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Bit</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Flip</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Walking</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Ones</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Walking</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Zeroes</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">8-bit</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Writes</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">16-bit</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Writes</span><span style="color:#E1E4E8;">       </span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ok</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">Done.</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># memtester 500M 1</span></span>
<span class="line"><span style="color:#6F42C1;">memtester</span><span style="color:#24292E;"> </span><span style="color:#032F62;">version</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">4.2</span><span style="color:#032F62;">.2</span><span style="color:#24292E;"> (64-bit)</span></span>
<span class="line"><span style="color:#6F42C1;">Copyright</span><span style="color:#24292E;"> (C) 2010 Charles Cazabon.</span></span>
<span class="line"><span style="color:#6F42C1;">Licensed</span><span style="color:#24292E;"> </span><span style="color:#032F62;">under</span><span style="color:#24292E;"> </span><span style="color:#032F62;">the</span><span style="color:#24292E;"> </span><span style="color:#032F62;">GNU</span><span style="color:#24292E;"> </span><span style="color:#032F62;">General</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Public</span><span style="color:#24292E;"> </span><span style="color:#032F62;">License</span><span style="color:#24292E;"> </span><span style="color:#032F62;">version</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> (only).</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">pagesize</span><span style="color:#24292E;"> </span><span style="color:#032F62;">is</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">4096</span></span>
<span class="line"><span style="color:#6F42C1;">pagesizemask</span><span style="color:#24292E;"> </span><span style="color:#032F62;">is</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0xfffffffffffff000</span></span>
<span class="line"><span style="color:#6F42C1;">want</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">500</span><span style="color:#032F62;">MB</span><span style="color:#24292E;"> (524288000 </span><span style="color:#032F62;">bytes</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#6F42C1;">got</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">500</span><span style="color:#032F62;">MB</span><span style="color:#24292E;"> (524288000 </span><span style="color:#032F62;">bytes</span><span style="color:#24292E;">), trying mlock ...locked.</span></span>
<span class="line"><span style="color:#6F42C1;">Loop</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Stuck</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Address</span><span style="color:#24292E;">       </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Random</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Value</span><span style="color:#24292E;">        </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Compare</span><span style="color:#24292E;"> </span><span style="color:#032F62;">XOR</span><span style="color:#24292E;">         </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Compare</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SUB</span><span style="color:#24292E;">         </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Compare</span><span style="color:#24292E;"> </span><span style="color:#032F62;">MUL</span><span style="color:#24292E;">         </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Compare</span><span style="color:#24292E;"> </span><span style="color:#032F62;">DIV</span><span style="color:#24292E;">         </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Compare</span><span style="color:#24292E;"> </span><span style="color:#032F62;">OR</span><span style="color:#24292E;">          </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Compare</span><span style="color:#24292E;"> </span><span style="color:#032F62;">AND</span><span style="color:#24292E;">         </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Sequential</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Increment:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Solid</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Bits</span><span style="color:#24292E;">          </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Block</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sequential</span><span style="color:#24292E;">    </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Checkerboard</span><span style="color:#24292E;">        </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Bit</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Spread</span><span style="color:#24292E;">          </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Bit</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Flip</span><span style="color:#24292E;">            </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Walking</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Ones</span><span style="color:#24292E;">        </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Walking</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Zeroes</span><span style="color:#24292E;">      </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">8-bit</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Writes</span><span style="color:#24292E;">        </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">16-bit</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Writes</span><span style="color:#24292E;">       </span><span style="color:#032F62;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ok</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">Done.</span></span></code></pre></div><p>这里可以看到，此时 memtester 已经成功申请到 500M 内存并且正常完成了内存测试。</p><p>到此，我们讲解了cgroups的 cpu 和 memroy 子系统，如果你想了解更多的cgroups的知识和使用，可以参考 <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/resource_management_guide/chap-introduction_to_control_groups" target="_blank" rel="noreferrer">Red Hat 官网</a>。</p><h4 id="删除-cgroups" tabindex="-1">删除 cgroups <a class="header-anchor" href="#删除-cgroups" aria-label="Permalink to &quot;删除 cgroups&quot;">​</a></h4><p>上面创建的cgroups如果不想使用了，直接删除创建的文件夹即可。</p><p>例如我想删除内存下的 mydocker 目录，使用以下命令即可：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># rmdir /sys/fs/cgroup/memory/mydocker/</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># rmdir /sys/fs/cgroup/memory/mydocker/</span></span></code></pre></div><p>学习了cgroups的使用方式，下面我带你了解一下 Docker 是如何使用cgroups的。</p><h3 id="docker-是如何使用cgroups的" tabindex="-1">Docker 是如何使用cgroups的？ <a class="header-anchor" href="#docker-是如何使用cgroups的" aria-label="Permalink to &quot;Docker 是如何使用cgroups的？&quot;">​</a></h3><p>首先，我们使用以下命令创建一个 nginx 容器：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">run</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-it</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-m=1g</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">run</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-it</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-m=1g</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx</span></span></code></pre></div><p>上述命令创建并启动了一个 nginx 容器，并且限制内存为 1G。然后我们进入cgroups内存子系统的目录，使用 ls 命令查看一下该目录下的内容：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># ls -l /sys/fs/cgroup/memory</span></span>
<span class="line"><span style="color:#B392F0;">total</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#B392F0;">-rw-r--r--.</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">11</span><span style="color:#9ECBFF;">:50</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup.clone_children</span></span>
<span class="line"><span style="color:#B392F0;">--w--w--w-.</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">11</span><span style="color:#9ECBFF;">:50</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup.event_control</span></span>
<span class="line"><span style="color:#B392F0;">-rw-r--r--.</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">11</span><span style="color:#9ECBFF;">:50</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup.procs</span></span>
<span class="line"><span style="color:#B392F0;">-r--r--r--.</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">11</span><span style="color:#9ECBFF;">:50</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup.sane_behavior</span></span>
<span class="line"><span style="color:#B392F0;">drwxr-xr-x.</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">:50</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker</span></span>
<span class="line"><span style="color:#79B8FF;">...</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">省略部分输出</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># ls -l /sys/fs/cgroup/memory</span></span>
<span class="line"><span style="color:#6F42C1;">total</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#6F42C1;">-rw-r--r--.</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">11</span><span style="color:#032F62;">:50</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup.clone_children</span></span>
<span class="line"><span style="color:#6F42C1;">--w--w--w-.</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">11</span><span style="color:#032F62;">:50</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup.event_control</span></span>
<span class="line"><span style="color:#6F42C1;">-rw-r--r--.</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">11</span><span style="color:#032F62;">:50</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup.procs</span></span>
<span class="line"><span style="color:#6F42C1;">-r--r--r--.</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">11</span><span style="color:#032F62;">:50</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup.sane_behavior</span></span>
<span class="line"><span style="color:#6F42C1;">drwxr-xr-x.</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">3</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#032F62;">:50</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker</span></span>
<span class="line"><span style="color:#005CC5;">...</span><span style="color:#24292E;"> </span><span style="color:#032F62;">省略部分输出</span></span></code></pre></div><p>通过上面输出可以看到，该目录下有一个 docker 目录，该目录正是 Docker 在内存子系统下创建的。我们进入到 docker 目录下查看一下相关内容：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># cd /sys/fs/cgroup/memory/docker</span></span>
<span class="line"><span style="color:#6A737D;"># ls -l</span></span>
<span class="line"><span style="color:#B392F0;">total</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#B392F0;">drwxr-xr-x.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">:49</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cb5c5391177b44ad87636bf3840ecdda83529e51b76a6406d6742f56a2535d5e</span></span>
<span class="line"><span style="color:#B392F0;">-rw-r--r--.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">:40</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup.clone_children</span></span>
<span class="line"><span style="color:#B392F0;">--w--w--w-.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">:40</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup.event_control</span></span>
<span class="line"><span style="color:#B392F0;">-rw-r--r--.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">:40</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cgroup.procs</span></span>
<span class="line"><span style="color:#79B8FF;">...</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">省略部分输出</span></span>
<span class="line"><span style="color:#B392F0;">-rw-r--r--.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Sep</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">:40</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tasks</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># cd /sys/fs/cgroup/memory/docker</span></span>
<span class="line"><span style="color:#6A737D;"># ls -l</span></span>
<span class="line"><span style="color:#6F42C1;">total</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#6F42C1;">drwxr-xr-x.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#032F62;">:49</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cb5c5391177b44ad87636bf3840ecdda83529e51b76a6406d6742f56a2535d5e</span></span>
<span class="line"><span style="color:#6F42C1;">-rw-r--r--.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#032F62;">:40</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup.clone_children</span></span>
<span class="line"><span style="color:#6F42C1;">--w--w--w-.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#032F62;">:40</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup.event_control</span></span>
<span class="line"><span style="color:#6F42C1;">-rw-r--r--.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#032F62;">:40</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cgroup.procs</span></span>
<span class="line"><span style="color:#005CC5;">...</span><span style="color:#24292E;"> </span><span style="color:#032F62;">省略部分输出</span></span>
<span class="line"><span style="color:#6F42C1;">-rw-r--r--.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Sep</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#032F62;">:40</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tasks</span></span></code></pre></div><p>可以看到 docker 的目录下有一个一串随机 ID 的目录，该目录即为我们上面创建的 nginx 容器的 ID。然后我们进入该目录，查看一下该容器的 memory.limit_in_bytes 文件的内容。</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># cd cb5c5391177b44ad87636bf3840ecdda83529e51b76a6406d6742f56a2535d5e</span></span>
<span class="line"><span style="color:#6A737D;"># cat memory.limit_in_bytes</span></span>
<span class="line"><span style="color:#B392F0;">1073741824</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># cd cb5c5391177b44ad87636bf3840ecdda83529e51b76a6406d6742f56a2535d5e</span></span>
<span class="line"><span style="color:#6A737D;"># cat memory.limit_in_bytes</span></span>
<span class="line"><span style="color:#6F42C1;">1073741824</span></span></code></pre></div><p>可以看到内存限制值正好为 1G。</p><p>事实上，Docker 创建容器时，Docker 会根据启动容器的参数，在对应的 cgroups 子系统下创建以容器 ID 为名称的目录, 然后根据容器启动时设置的资源限制参数, 修改对应的 cgroups 子系统资源限制文件, 从而达到资源限制的效果。</p><h3 id="小结" tabindex="-1">小结 <a class="header-anchor" href="#小结" aria-label="Permalink to &quot;小结&quot;">​</a></h3><p>本课时我们讲解了什么是 cgroups，以及 cgroups 可以为我们提供哪些核心功能。其实 cgroups 不仅可以实现资源的限制，还可以为我们统计资源的使用情况，容器监控系统的数据来源也是 cgroups 提供的。</p><p>另外，请注意 cgroups 虽然可以实现资源的限制，但是不能保证资源的使用。例如，cgroups 限制某个容器最多使用 1 核 CPU，但不保证总是能使用到 1 核 CPU，当 CPU 资源发生竞争时，可能会导致实际使用的 CPU 资源产生竞争。</p><p>那么，你知道cgroups还有哪些子系统吗？思考后，把你的想法写在留言区。</p>`,90),e=[l];function r(c,t,y,E,F,C){return n(),a("div",null,e)}const u=s(o,[["render",r]]);export{B as __pageData,u as default};
