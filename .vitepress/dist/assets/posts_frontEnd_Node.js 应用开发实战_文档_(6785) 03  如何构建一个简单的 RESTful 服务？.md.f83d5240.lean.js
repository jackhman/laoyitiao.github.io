import{_ as o,D as e,o as t,g as r,J as l,h as n,Q as p,m as s}from"./chunks/framework.f67d7268.js";const X=JSON.parse('{"title":"03如何构建一个简单的RESTful服务？","description":"","frontmatter":{},"headers":[],"relativePath":"posts/frontEnd/Node.js 应用开发实战_文档/(6785) 03  如何构建一个简单的 RESTful 服务？.md","filePath":"posts/frontEnd/Node.js 应用开发实战_文档/(6785) 03  如何构建一个简单的 RESTful 服务？.md","lastUpdated":1696682708000}'),c={name:"posts/frontEnd/Node.js 应用开发实战_文档/(6785) 03  如何构建一个简单的 RESTful 服务？.md"},E=p("",11),y=s("p",null,"此模式中：",-1),i=s("ul",null,[s("li",null,[s("p",null,"M（Model）层处理数据库相关的操作（只有数据库操作时）；")]),s("li",null,[s("p",null,"C（Controller）层处理业务逻辑；")]),s("li",null,[s("p",null,"V（View）层则是页面显示和交互（本讲不涉及）。")])],-1),d=s("p",null,"但是在目前服务划分较细的情况下，M 层不仅仅是数据库操作，因此这种架构模式显得有些力不从心，导致开发的数据以及业务逻辑有时候在 M 层，有时候却在 C 层。出现这类情况的核心原因是 C 与 C 之间无法进行复用，如果需要复用则需要放到 M 层，那么业务逻辑就会冗余在 M，代码会显得非常繁杂，如图 2 所示。",-1),u=s("p",null,"图 2 MVC 模式问题",-1),F=s("p",null,"为了解决以上问题，在经过一些实践后，我在研发过程中提出了一套新的架构模式，当然也有他人提到过（比如 Eggjs 框架中的模式）。这种模式也会应用在本专栏的整个架构体系中，我们暂且叫作 MSVC（Model、Service、View、Controller）。",-1),h=s("p",null,"我们先来看下 MSVC 的架构模式，如图 3 所示。",-1),g=s("p",null,"将所有数据相关的操作都集中于 M 层，而 M 层复用的业务逻辑则转到新的 S 层，C 层则负责核心业务处理，可以调用 M 和 S 层。以上是相关知识点，接下来我们进行架构的实践设计。",-1),_=s("h3",{id:"系统实践",tabindex:"-1"},[n("系统实践 "),s("a",{class:"header-anchor",href:"#系统实践","aria-label":'Permalink to "系统实践"'},"​")],-1),C=s("p",null,"我们先实现一个简单版本的 RESTful 服务，其次为了能够更清晰地了解 MVC 架构和 MSVC 架构的优缺点，我们也会分别实现两个版本的 RESTful 服务。",-1),A=s("p",null,[n("我们要实现的是一个"),s("strong",null,"获取用户发帖的列表信息 API"),n("，该 API 列表的内容包含两部分，一部分是从数据库获取的发帖内容，但是这部分只包含用户 ID，另外一部分则是需要通过 ID 批量拉取用户信息。")],-1),v=s("p",null,"我们先来设计 RESTful API，由于是拉取列表内容接口，因此这里设计为一个 GET 接口，根据 RESTful 约束规则设计为：GET /v1/contents；另外还需要设计一个独立的服务用来获取用户信息，将接口设计为：GET /v1/userinfos。",-1),f=s("p",null,"为了更清晰些，我绘制了一个时序图来表示，如图 4 所示。",-1),D=p("",18),m=p("",7),B=p("",4),b=p("",4),M=p("",7),S=p("",8),T=p("",6),k=s("p",null,"图 10 Controller 基类",-1),q=s("p",null,"功能还是比较简单的，只是提炼了一些 Controller 共同的部分。接下来我们再来实现 content.js 这个 Controller，代码如图 11 所示：",-1),I=p("",8),P=s("p",null,"图 12 Model 基类",-1),V=s("p",null,"这个基类首先设置了 db 名称，其次定义了一个 GET 方法来获取表的操作句柄，这部分代码与上面简单 restful 服务的类似。完成基类后，我们再来完善 model 中的 content.js 逻辑。",-1),j=p("",7),R=s("p",null,"图 14 MVC 复用性问题例子",-1),w=s("p",null,"其中左边是存在的矛盾，因为 _filterUserinfo 在 Controller 是私有方法，recommend Controller 调用不到，那么为了复用，我们只能将该方法封装到 content-model 中，并且将数据也集中在 Model 层去。",-1),x=s("p",null,"虽然解决了问题，但是你会发现：",-1),H=s("ul",null,[s("li",null,[s("p",null,"Model 层不干净了，它现在既要负责数据处理，又要负责业务逻辑；")]),s("li",null,[s("p",null,"Controller 层的业务减少了，但是分层不明确了，有些业务放在 Model，有些又在 Controller 层，对于后期代码的维护或者扩展都非常困难了。")])],-1),N=s("p",null,"为了解决这个问题，有一个新的概念------Service 层，具体如图 15 所示。",-1),L=p("",13),U=s("p",null,[n("]("),s("a",{href:"https://shenceyun.lagou.com/t/mka",target:"_blank",rel:"noreferrer"},"https://shenceyun.lagou.com/t/mka"),n(")")],-1),W=s("p",null,[s("strong",null,"《大前端高薪训练营》")],-1),O=s("p",null,[n("对标阿里 P7 技术需求 + 每月大厂内推，6 个月助你斩获名企高薪 Offer。"),s("a",{href:"https://shenceyun.lagou.com/t/mka",target:"_blank",rel:"noreferrer"},"点击链接"),n("，快来领取！")],-1);function G(J,K,$,Q,z,Z){const a=e("Image");return t(),r("div",null,[E,l(a,{alt:"图片 2.png",src:"https://s0.lgstatic.com/i/image6/M00/17/08/CioPOWBHMl-ASR4aAAAg3opNISU640.png"}),n(),y,i,d,l(a,{alt:"图片 4.png",src:"https://s0.lgstatic.com/i/image6/M00/17/0C/Cgp9HWBHMnaAG42WAAA3-AZ5WeM867.png"}),n(),u,F,h,l(a,{alt:"图片 6.png",src:"https://s0.lgstatic.com/i/image6/M00/17/09/CioPOWBHMomAfpfmAABDDmUKgC4829.png"}),n(),g,_,C,A,v,f,l(a,{alt:"图片 7.png",src:"https://s0.lgstatic.com/i/image6/M00/17/0C/Cgp9HWBHMpOASLZ7AACJ0Un2XOA103.png"}),n(),D,l(a,{alt:"图片 8.png",src:"https://s0.lgstatic.com/i/image6/M01/17/09/CioPOWBHMqSAeQfTAAF5ba4WuFA603.png"}),n(),m,l(a,{alt:"图片 9.png",src:"https://s0.lgstatic.com/i/image6/M00/17/0D/Cgp9HWBHMqyAFEfxAACiD747m4U810.png"}),n(),B,l(a,{alt:"图片 10.png",src:"https://s0.lgstatic.com/i/image6/M01/17/0D/Cgp9HWBHMrWAHu5_AAFIdt9MME4795.png"}),n(),b,l(a,{alt:"图片 11.png",src:"https://s0.lgstatic.com/i/image6/M01/17/0D/Cgp9HWBHMr-AKdSMAAFW1ay8vPI075.png"}),n(),M,l(a,{alt:"图片 12.png",src:"https://s0.lgstatic.com/i/image6/M01/17/0D/Cgp9HWBHMsyAF-PaAAB-xAx-32s648.png"}),n(),S,l(a,{alt:"图片 13.png",src:"https://s0.lgstatic.com/i/image6/M01/17/0D/Cgp9HWBHMtiAAs7YAAJNxih_ssE949.png"}),n(),T,l(a,{alt:"图片 14.png",src:"https://s0.lgstatic.com/i/image6/M01/17/0B/CioPOWBHMxSAAxc8AAF_MvEbU10031.png"}),n(),k,q,l(a,{alt:"图片 15.png",src:"https://s0.lgstatic.com/i/image6/M01/17/0E/Cgp9HWBHMwaAMQK8AAD-onTOdVQ611.png"}),n(),I,l(a,{alt:"图片 16.png",src:"https://s0.lgstatic.com/i/image6/M00/17/0B/CioPOWBHMx2AHsKzAAEYhjLBhO4974.png"}),n(),P,V,l(a,{alt:"图片 17.png",src:"https://s0.lgstatic.com/i/image6/M01/17/0E/Cgp9HWBHMyeAPElfAAEk45BmKsI006.png"}),n(),j,l(a,{alt:"图片 18.png",src:"https://s0.lgstatic.com/i/image6/M00/17/0B/CioPOWBHMzCANv2nAAFcFfow9m4167.png"}),n(),R,w,x,H,N,l(a,{alt:"图片 19.png",src:"https://s0.lgstatic.com/i/image6/M00/17/0E/Cgp9HWBHMzqAc1JJAAFspSJGcu8417.png"}),n(),L,l(a,{alt:"Drawing 2.png",src:"https://s0.lgstatic.com/i/image6/M00/12/FA/CioPOWBBrAKAAod-AASyC72ZqWw233.png"}),n(),U,W,O])}const ss=o(c,[["render",G]]);export{X as __pageData,ss as default};
