import{_ as o,j as e,o as t,g as r,k as l,h as a,s,Q as p}from"./chunks/framework.4e7d56ce.js";const K=JSON.parse('{"title":"什么是 SSRF 漏洞？ ","description":"","frontmatter":{},"headers":[],"relativePath":"posts/backEnd/Web 安全攻防之道_文档/(5978) 10  SSRF 漏洞：外网隔离就绝对安全了吗？.md","filePath":"posts/backEnd/Web 安全攻防之道_文档/(5978) 10  SSRF 漏洞：外网隔离就绝对安全了吗？.md","lastUpdated":1696417798000}'),c={name:"posts/backEnd/Web 安全攻防之道_文档/(5978) 10  SSRF 漏洞：外网隔离就绝对安全了吗？.md"},i=s("p",null,"上一讲我们介绍了 CSRF 漏洞的产生原理、攻击手法、检测与防御手段，这一讲开始我会向你介绍 SSRF。",-1),y=s("p",null,"从名字来看，SSRF 跟 CSRF 就有点相近，其实它们的技术原理也有相似之处，但攻击目标是完全不同的：SSRF 是针对服务端的攻击。",-1),E=s("p",null,"想知道更具体的技术细节吗？跟我一块学习下面的内容吧！",-1),h=s("h3",{id:"什么是-ssrf-漏洞",tabindex:"-1"},[a("什么是 SSRF 漏洞？ "),s("a",{class:"header-anchor",href:"#什么是-ssrf-漏洞","aria-label":'Permalink to "什么是 SSRF 漏洞？"'},"​")],-1),d=s("p",null,"SSRF（Server-Side Request Forgery，服务端请求伪造）是指攻击者向服务端发送包含恶意 URL 链接的请求，借由服务端去访问此 URL ，以获取受保护网络内的资源的一种安全漏洞。SSRF 常被用于探测攻击者无法访问到的网络区域，比如服务器所在的内网，或是受防火墙访问限制的主机。",-1),F=s("p",null,"SSRF 漏洞的产生，主要是因为在服务端的 Web 应用，需要从其他服务器拉取数据资源，比如图片、视频、文件的上传/下载、业务数据处理结果，但其请求地址可被外部用户控制。",-1),g=s("p",null,"请求地址被恶意利用的话，如下图所示，就能够以服务端的身份向任意地址发起请求，如果是一台存在远程代码执行漏洞的内网机器，借助 SSRF 漏洞就可以获取该内网机器的控制权。",-1),u=p("",4),_=p("",4),S=p("",12),A=s("p",null,"图 4：常用于 SSRF 的 URL Scheme",-1),C=s("p",null,[a("在利用初期，你可以尝试下目标支持哪些 URL Schema，但有一点需要提醒下："),s("strong",null,"有些应用会自定义一些 URL Schema，如果它支持本地或网络地址请求，要注意避免遗漏掉"),a("。")],-1),D=s("h4",{id:"_2-读取本地文件",tabindex:"-1"},[a("2.读取本地文件 "),s("a",{class:"header-anchor",href:"#_2-读取本地文件","aria-label":'Permalink to "2.读取本地文件"'},"​")],-1),b=s("p",null,"从图 4 可以看到，除了 http/https 协议外，File 也是各场景通用的伪协议，利用它我们可以读取服务器的本地文件，比如 /etc/passwd、/proc/self/environ......",-1),f=p("",19),R=p("",11),m=s("p",null,"图 7：BurpSuite 默认提供 Collaborator Server 作为 DNS 解析服务器",-1),v=s("p",null,"关于 Burp Collaborator 原理，我们可以看下面这张图：",-1),k=s("p",null,"图 8：Burp Collaborator 原理",-1),T=s("p",null,"图中可以看到，先利用 SSRF 漏洞让目标应用向 Burp 提供的 DNS 解析服务器 Burp Collaborator Server 发起请求，然后 Burp Collaborator Server 会查询对应的 DNS 请求记录并返回给 BurpSuite，从而帮助测试者判断 SSRF 漏洞是否存在。",-1),B=s("p",null,"仍以前面的靶场题目为例，打开 Burp Collaborator Client：",-1),P=s("p",null,'图 9：选择菜单"Burp Collaborator client"',-1),L=p("",4),x=s("p",null,"图 11：获得 DNS 请求日志证明存在 SSRF 漏洞",-1),q=s("p",null,"这个检测方法比较通用简单，且无须自己搭建 DNS 服务器，非常方便，我强烈推荐。",-1),w=s("h4",{id:"_2-工具-ssrfmap",tabindex:"-1"},[a("2.工具：SSRFmap "),s("a",{class:"header-anchor",href:"#_2-工具-ssrfmap","aria-label":'Permalink to "2.工具：SSRFmap"'},"​")],-1),X=s("p",null,[a("这里给大家介绍一款 SSRF 检测工具："),s("a",{href:"https://github.com/swisskyrepo/SSRFmap",target:"_blank",rel:"noreferrer"},"SSRFmap"),a("，利用它可检测与利用 SSRF 漏洞， 同时它也整合了一些常用漏洞可以结合 SSRF 去利用，比如 fastjson、mysql、github 的一些历史漏洞，还有端口扫描、读取文件等利用功能，都是实用的漏洞利用能力。")],-1),$=s("p",null,"使用上会比 Burp Collaborator 便捷，但检测能力上其实没有 Burp Collaborator 那样准确，SSRFmap 有时会利用失败。所以个人推荐使用 Burp Collaborator 用来检测 SSRF 是否存在，再使用 SSRFmap 做一些漏洞利用，比如读取敏感文件等操作。",-1),I=s("p",null,"SSRFmap 是以 HTTP 请求数据作为文件输入，使用命令如下：",-1),N=p("",6),U=p("",22),j=s("p",null,"图 14：SSRF Search & Destory",-1),M=s("p",null,[a("最后我要推荐一篇文章"),s("a",{href:"https://www.sohu.com/a/440098632_99907709",target:"_blank",rel:"noreferrer"},"《SSRF 引发的血案》"),a("，通过信息收集、SSRF 漏洞、旁站路径泄露，最终获取目标网站的 root shell。这篇文章很有实战参考意义，既体现出了信息收集的重要性，又表明了 SSRF 的危害。")],-1),O=s("p",null,"在 SSRF 漏洞的检测和防御中，如果你遇到了什么问题，欢迎在评论区留言。",-1),H=s("p",null,"下一讲，我将带你了解 XXE 漏洞，它是一种帮助计算机理解信息符号并处理各种信息的语言，主要用来传递结构化的数据信息。",-1);function G(V,W,Q,z,Y,Z){const n=e("Image");return t(),r("div",null,[i,y,E,h,d,F,g,l(n,{alt:"图片1.png",src:"https://s0.lgstatic.com/i/image2/M01/05/7E/CgpVE2AADgaALnqEAAU0JhFZzR0654.png"}),a(),u,l(n,{alt:"Drawing 1.png",src:"https://s0.lgstatic.com/i/image/M00/8D/8C/Ciqc1F___H-AGVMFAACkzV98r_I798.png"}),a(),_,l(n,{alt:"图片3.png",src:"https://s0.lgstatic.com/i/image2/M01/05/7C/Cip5yGAADhCAWSnNAAdaKZQ9ykM424.png"}),a(),S,l(n,{alt:"图片4.png",src:"https://s0.lgstatic.com/i/image/M00/8D/9D/CgqCHmAADh6AFbrRAAIMts5NwrM049.png"}),a(),A,C,D,b,l(n,{alt:"Drawing 4.png",src:"https://s0.lgstatic.com/i/image/M00/8D/8C/Ciqc1F___JyAXxb8AAFuJktUmQY503.png"}),a(),f,l(n,{alt:"图片6.png",src:"https://s0.lgstatic.com/i/image/M00/8D/9D/CgqCHmAADkGAIcZZAAMGZOUjpvY507.png"}),a(),R,l(n,{alt:"Drawing 6.png",src:"https://s0.lgstatic.com/i/image/M00/8D/8C/Ciqc1F___M6AM-F0AAB4EJZT7Og734.png"}),a(),m,v,l(n,{alt:"Drawing 7.png",src:"https://s0.lgstatic.com/i/image/M00/8D/8C/Ciqc1F___NaAO7ZxAABr-AfFp10030.png"}),a(),k,T,B,l(n,{alt:"图片9.png",src:"https://s0.lgstatic.com/i/image2/M01/05/7C/Cip5yGAADl-ANvjXAALr6lgnhiU452.png"}),a(),P,l(n,{alt:"Drawing 9.png",src:"https://s0.lgstatic.com/i/image/M00/8D/8C/Ciqc1F___OaARRUKAAA1N0CwrBA260.png"}),a(),L,l(n,{alt:"Drawing 10.png",src:"https://s0.lgstatic.com/i/image/M00/8D/8C/Ciqc1F___PCAJA70AABnCpr9zFk818.png"}),a(),x,q,w,X,$,I,l(n,{alt:"Drawing 11.png",src:"https://s0.lgstatic.com/i/image/M00/8D/8C/Ciqc1F___PiASgPlAAEZ_x3Bz0k961.png"}),a(),N,l(n,{alt:"Drawing 12.png",src:"https://s0.lgstatic.com/i/image/M00/8D/98/CgqCHl___QOAXop9AAFeL92aWyk084.png"}),a(),U,l(n,{alt:"图片14.png",src:"https://s0.lgstatic.com/i/image/M00/8D/9D/CgqCHmAADwWABCT2AAiRZWxBE54491.png"}),a(),j,M,O,H,l(n,{alt:"web安全10金句.png",src:"https://s0.lgstatic.com/i/image/M00/8D/9D/CgqCHmAADyOAB9URAAVCqo4Bquk815.png"})])}const ss=o(c,[["render",G]]);export{K as __pageData,ss as default};
