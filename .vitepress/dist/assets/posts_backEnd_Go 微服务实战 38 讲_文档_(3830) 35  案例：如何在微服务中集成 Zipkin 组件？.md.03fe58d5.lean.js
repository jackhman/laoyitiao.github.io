import{_ as o,j as e,o as t,g as r,k as p,h as n,s,Q as l}from"./chunks/framework.4e7d56ce.js";const f=JSON.parse('{"title":"应用架构图 ","description":"","frontmatter":{},"headers":[],"relativePath":"posts/backEnd/Go 微服务实战 38 讲_文档/(3830) 35  案例：如何在微服务中集成 Zipkin 组件？.md","filePath":"posts/backEnd/Go 微服务实战 38 讲_文档/(3830) 35  案例：如何在微服务中集成 Zipkin 组件？.md","lastUpdated":1696417798000}'),c={name:"posts/backEnd/Go 微服务实战 38 讲_文档/(3830) 35  案例：如何在微服务中集成 Zipkin 组件？.md"},E=s("p",null,"这一课时我们就来进行案例实战，选择当前流行的链路追踪组件 Zipkin 作为示例，演示如何在 Go 微服务中集成 Zipkin。对于很多使用了 Go 微服务框架的用户来说，其框架本身就拥有 Trace 模块，如 Go-kit。所以本课时我们就在 Go-kit 微服务的案例中集成 Zipkin。",-1),y=s("p",null,[n("Zipkin 社区提供了诸如 zipkin-go、zipkin-go-opentracing、go-zipkin 等 Go 客户端库，后面我们会介绍如何将其中的 zipkin-go-opentracing（组件地址参见 "),s("a",{href:"https://github.com/openzipkin-contrib/zipkin-go-opentracing%EF%BC%89%E9%9B%86%E6%88%90%E5%88%B0%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%B8%AD%E5%B9%B6%E5%8A%A0%E4%BB%A5%E5%BA%94%E7%94%A8%E3%80%82",target:"_blank",rel:"noreferrer"},"https://github.com/openzipkin-contrib/zipkin-go-opentracing）集成到微服务中并加以应用。")],-1),i=s("p",null,"Go-kit 微服务框架的 tracing 包为服务提供了 Dapper 样式的请求追踪。Go-kit 支持 OpenTracing API，并使用 opentracing-go 包为其服务器和客户端提供追踪中间件。Zipkin、LightStep 和 AppDash 是已支持的追踪组件，通过 OpenTracing API 与 Go-kit 一起使用。",-1),g=s("h3",{id:"应用架构图",tabindex:"-1"},[n("应用架构图 "),s("a",{class:"header-anchor",href:"#应用架构图","aria-label":'Permalink to "应用架构图"'},"​")],-1),F=s("p",null,[n("本课时将会介绍如何在 Go-kit 中集成 Zipkin 进行链路调用的追踪，包括"),s("strong",null,"HTTP 和 gRPC 两种调用方式"),n("。在具体介绍这两种调用方式之前，我们先来看一下 Go-kit 集成 Zipkin 的应用架构，如下图所示：")],-1),u=l("",26),d=s("p",null,"结果验证截图",-1),C=s("p",null,"可以看到，通过网关，我们可以正常访问字符串服务提供的接口。下面我们通过 Zipkin UI 来查看本次链路调用的信息，如下图所示：",-1),h=s("p",null,"Zipkin UI 查看链路调用的信息截图",-1),k=s("p",null,'在浏览器请求之后，可以在 Zipkin UI 中看到发送的请求记录（单击上方"Try Lens UI"切换成了 Lens UI，效果还不错），点击查看详细的链路调用情况，如下图所示：',-1),T=s("p",null,"Lens UI 截图",-1),v=s("p",null,"从调用链中可以看到，本次请求涉及两个服务：gateway-service 和 string-service。",-1),A=s("p",null,"整个链路有 3 个 Span：gateway、HTTP-transport 和 string-endpoint，确实如我们所定义的一样。这里我们主要看一下网关中的 Gateway Span 详情，如下图所示：",-1),D=l("",26);function q(B,P,S,b,m,z){const a=e("Image");return t(),r("div",null,[E,y,i,g,F,p(a,{alt:"Drawing 0.png",src:"https://s0.lgstatic.com/i/image/M00/5E/75/Ciqc1F-GvryAbSsGAABD2LP4yN8428.png"}),n(),u,p(a,{alt:"Drawing 1.png",src:"https://s0.lgstatic.com/i/image/M00/5E/75/Ciqc1F-GvvSAdvD2AAJxdVYATAU644.png"}),n(),d,C,p(a,{alt:"Drawing 2.png",src:"https://s0.lgstatic.com/i/image/M00/5E/80/CgqCHl-GvvqAccZPAAPASa8eLYA067.png"}),n(),h,k,p(a,{alt:"Drawing 3.png",src:"https://s0.lgstatic.com/i/image/M00/5E/75/Ciqc1F-GvwOAO5wJAANEaW1O3C4296.png"}),n(),T,v,A,p(a,{alt:"Drawing 4.png",src:"https://s0.lgstatic.com/i/image/M00/5E/80/CgqCHl-GvwuASVfGAAcZvmOB0Kc881.png"}),n(),D,p(a,{alt:"Drawing 5.png",src:"https://s0.lgstatic.com/i/image/M00/5E/81/CgqCHl-GvzeAWzGRAASmhMb8V3c466.png"})])}const R=o(c,[["render",q]]);export{f as __pageData,R as default};
