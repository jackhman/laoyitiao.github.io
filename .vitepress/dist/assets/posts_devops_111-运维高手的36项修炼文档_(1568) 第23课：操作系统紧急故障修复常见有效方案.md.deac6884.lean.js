import{_ as i,j as e,o as a,g as p,k as l,s as t,h as c,Q as o}from"./chunks/framework.4e7d56ce.js";const Q=JSON.parse('{"title":"操作系统模块 ","description":"","frontmatter":{},"headers":[],"relativePath":"posts/devops/111-运维高手的36项修炼文档/(1568) 第23课：操作系统紧急故障修复常见有效方案.md","filePath":"posts/devops/111-运维高手的36项修炼文档/(1568) 第23课：操作系统紧急故障修复常见有效方案.md","lastUpdated":1696417798000}'),n={name:"posts/devops/111-运维高手的36项修炼文档/(1568) 第23课：操作系统紧急故障修复常见有效方案.md"},_=t("p",null,"你好，我是你的运维课老师 Jeson，本课时我们主要讲解操作系统故障时修复的常见有效方案。",-1),g=t("p",null,"通常操作系统遇到的一些灾难性故障，会导致操作系统无法正常运行、启动或是运维人员无法进行管理。我们想要学习解决操作系统的故障，就必须了解操作系统依赖的一些核心模块。",-1),r=t("h4",{id:"操作系统模块",tabindex:"-1"},[c("操作系统模块 "),t("a",{class:"header-anchor",href:"#操作系统模块","aria-label":'Permalink to "操作系统模块"'},"​")],-1),u=o("",27),h=t("p",null,"在这里，我以 Centos 6 和 Centos 7 的版本来分别进行介绍，Centos 6 的操作如下：",-1),A=t("ol",null,[t("li",null,"启动界面任意按一个字符，进入选择启动项菜单。"),t("li",null,"在启动菜单（GRUB）读秒界面按 e 键进入编辑模式。"),t("li",null,'用上下键移动到"kernel"行，按 e 进入行编辑模式。'),t("li",null,"在行编辑界面，在行末尾键入s、S、1 或者 single。")],-1),m=t("p",null,"然后进行保存、重启就可以告诉系统重启后以单用户模式加载启动操作系统，这是 Centos 6 进入单用户模式的操作流程，相比 Centos 6 ， Centos 7的进去单用模式可能略显复杂。",-1),d=o("",7),C=t("p",null,"我的操作系统挂载了两块硬盘，硬盘 1 为系统盘，硬盘 2 为数据盘，光盘这里挂载到了与已安装的操作系统 Centos 7 一样版本的 ISO 镜像，演示中进入的救援模式是需要 CD/DVD 介质来启动进入。",-1),B=t("p",null,"接下来进入我正在运行的操作系统里面，登录进入系统，首先需要模拟损坏 GURB。",-1),b=t("p",null,"进入 /boot 目录下输入 ls 会看到 GRUB 对应的文件目录，然后通过 rm -rf grub* 删除 GRUB 的文件目录。",-1),j=t("p",null,"再次输入 ls，可以发现 GRUB 的文件目录就已经没有了。",-1),R=t("p",null,"然后重启操作系统，这个时候会提示文件没有找到，需要进入救援模式的界面。",-1),M=t("p",null,"这个时候就需要通过光碟进入救援模式，首先通过设置引导介质为光碟，然后重启启动。这样就模拟了一个 BIOS 设置引导介质过程，通过新的介质启动虚拟机。",-1),U=t("p",null,"这个时候你会发现通过 BIOS 会直接进入一个安装的启动界面，然后选择 Centos 7 救援模式的按钮，这样就进入确认界面，然后点击确认就会启动救援模式。",-1),q=t("p",null,"这里会加载启动救援模式必需的操作系统内核和服务程序。",-1),G=t("p",null,"这里输入 1，就进入了救援模式，并进入了一个 Shell 的交互界面了，这样我们就可以通过输入命令来修复已经损坏的 GRUB 文件。",-1),f=t("p",null,"首先，我需要输入的是 chroot 命令（chroot /mnt/sysimage/），chroot 命令负责切换到原来的管理目录结构下，这时再输入 ls 会看到 / 目录下的文件内容及结构就是磁盘 1 （原系统盘）上的所有操作系统的磁盘文件，接下来我需要修复 GRUB。",-1),x=t("p",null,"修复 GRUB，Centos 7 有对应的成熟的命令，首先新建一个目录（mkdir /boot/grub2），因为我们刚才把整个文件目录做了删除。",-1),S=t("p",null,"然后在输入 grub2 -mkconfig -o /boot/grub2/grub.cfg，这样就可以按照对应的路径要求生成配置文件。",-1),I=t("p",null,"然后执行 grub2-install /dev/sda（添加需要修复系统所在的磁盘的设备）。",-1),T=t("p",null,"这个时候我们就可以通过 ls 命令查看对应目录下有没有文件生成，如果有文件生成以后就可以重启操作系统，",-1),F=t("p",null,"然后在 BIOS 中将启动介质设置为磁盘 1，然后重启启动，这个时候会看到正常进入 GRUB 的选择菜单栏里，这个时候选择默认的第一个启动菜单项。",-1),O=t("p",null,"这时，我们观察下启动过程，会发现启动停留在一个 selinux 报错上，导致后面一直无法启动，这个时候我们还需要修复下，在启动的时候不去加载 selinux。",-1),E=t("p",null,'这个时候可以选择重新启动磁盘，然后在启动过程中修改启动 GRUB 的配置，，把 selinux 设置为禁用，这时需要重启启动虚拟机，然后按 e键进入 GRUB 菜单中编辑，找到" Linux 16" 这一行并在" centos/swap" 后面输入 selinux = 0 把 selinux 临时禁用（永久关闭的方式请见课时8），这样在启动过程中就不再加载 selinux 的相关策略。',-1),P=t("p",null,"然后按住 control + X 继续启动，就可以进入到登录界面，说明操作系统正常启动。",-1),k=t("p",null,"好了，本课时内容就全部讲完了，如果你遇到相应的问题可以尝试用今天讲到的方法尝试修复操作系统故障。",-1);function H(L,V,v,D,N,w){const s=e("Image");return a(),p("div",null,[_,g,r,l(s,{alt:"1.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/44/Ciqc1F66a-OAPlCNAAIm5pCaK9U962.jpg"}),u,l(s,{alt:"2.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/44/CgqCHl66a_yAAvcMAAEMHAiOI_A313.jpg"}),h,A,m,l(s,{alt:"3.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/44/Ciqc1F66bASAZ7p_AABx_fUX-gY425.jpg"}),d,l(s,{alt:"4.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/44/CgqCHl66bA2AM-vuAABLSq_t41U364.jpg"}),C,B,l(s,{alt:"5.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/44/CgqCHl66bB2AVJwFAACveDe3Ia4694.jpg"}),b,l(s,{alt:"6.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/44/Ciqc1F66bCSAaCI3AAEn4wHWpb0519.jpg"}),j,l(s,{alt:"7.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/44/Ciqc1F66bCyAfM7FAAAvPF0DDv4130.jpg"}),R,M,l(s,{alt:"8.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/44/Ciqc1F66bDSAeMsVAABGEtLIoIQ378.jpg"}),U,l(s,{alt:"9.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/44/Ciqc1F66bDuAOuSNAADMrAEagRY261.jpg"}),q,l(s,{alt:"10.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/44/Ciqc1F66bEGAYEcOAAEoAMQ3u00725.jpg"}),G,l(s,{alt:"11.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/44/CgqCHl66bEmATe3oAAAx4fNQ8RQ164.jpg"}),f,l(s,{alt:"12.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/44/CgqCHl66bF2AdAI3AAANA6T4YWM710.jpg"}),x,l(s,{alt:"13.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/44/Ciqc1F66bGKAb3hQAABJCj_36rw341.jpg"}),l(s,{alt:"14.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/44/Ciqc1F66bGuAWYrCAABLIALdS3M504.jpg"}),S,l(s,{alt:"15.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/44/Ciqc1F66bHOAEm3PAAAfY1xGwoU495.jpg"}),I,l(s,{alt:"16.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/45/CgqCHl66bHuAXyiiAAAmz6_nPZo827.jpg"}),T,l(s,{alt:"17.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/45/Ciqc1F66bIOAVgJcAABUL1FHMtM765.jpg"}),F,l(s,{alt:"18.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/45/CgqCHl66bIuAECi-AAA33rT3QlU625.jpg"}),O,l(s,{alt:"19.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/45/CgqCHl66bJaAZoaXAAEhYTMITew904.jpg"}),E,l(s,{alt:"20.jpg",src:"https://s0.lgstatic.com/i/image/M00/08/45/Ciqc1F66bNaAM40mAAAXBpmReRQ703.jpg"}),P,k])}const Y=i(n,[["render",H]]);export{Q as __pageData,Y as default};
