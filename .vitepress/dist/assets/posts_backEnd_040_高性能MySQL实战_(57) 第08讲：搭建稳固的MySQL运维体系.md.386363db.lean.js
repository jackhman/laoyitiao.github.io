import{_ as o,j as e,o as s,h as _,k as t,f as i,Q as a,s as l}from"./chunks/framework.d3daa342.js";const F=JSON.parse('{"title":"第08讲：搭建稳固的MySQL运维体系","description":"","frontmatter":{},"headers":[],"relativePath":"posts/backEnd/040_高性能MySQL实战/(57) 第08讲：搭建稳固的MySQL运维体系.md","filePath":"posts/backEnd/040_高性能MySQL实战/(57) 第08讲：搭建稳固的MySQL运维体系.md","lastUpdated":1696682708000}'),S={name:"posts/backEnd/040_高性能MySQL实战/(57) 第08讲：搭建稳固的MySQL运维体系.md"},n=a("",10),c=a("",10),r=l("p",null,"redo log、 replication、semi-Replication 和 PXC 的监控项，如下所示。",-1),L=l("h3",{id:"常用监控系统",tabindex:"-1"},[i("常用监控系统 "),l("a",{class:"header-anchor",href:"#常用监控系统","aria-label":'Permalink to "常用监控系统"'},"​")],-1),h=l("p",null,"知道如何采集监控指标数据后，就可以编写采集脚本或程序进行数据采集了，数据采集后推送给监控系统进行数据展示。常见的监控系统有 Nagios、Cacti、Zabbix、PMM 及自研监控告警系统。",-1),Q=l("p",null,"其中 Nagios、Cacti 监控系统对于 MySQL 而言，功能较弱。例如 Nagios 不支持趋势图只关心状态是否正常，Cacti 报警通知机制较弱。",-1),M=l("p",null,"使用比较广泛的 Zabbix 监控系统对 MySQL 的监控模版较少，需要定制监控模版。",-1),d=l("p",null,"PMM 是 Percona 推出的 MySQL 监控系统，相比其他系统更聚焦于对数据库的监控告警。它是一款开源的用于管理和监控 MySQL 和 MongoDB 性能的开源监控平台，通过 PMM 客户端收集 DB 监控数据并使用第三方软件 Grafana 画图展示出来。",-1),A=l("h3",{id:"自研监控告警系统",tabindex:"-1"},[i("自研监控告警系统 "),l("a",{class:"header-anchor",href:"#自研监控告警系统","aria-label":'Permalink to "自研监控告警系统"'},"​")],-1),g=l("p",null,"如果你需要自主研发监控告警系统，可以考虑采用推送和拉取结合的架构模式，如下图所示。",-1),m=a("",29),u=l("p",null,"上图是语法检查的结果，只需要提交 SQL 语句即可快速判断 SQL 语句是否存在语法、语义错误。",-1),y=l("p",null,"当提交的 SQL 语句存在错误或警告时会提示你具体哪一行需要修改，这个阶段可以嵌入开发规则和自定义规范来规范提交的 SQL 语句。",-1),T=a("",6),E=l("p",null,"如上图所示，代码审核的截图能够显示具体应用调用的模块名、服务名、方法、来源 IP、协议、类型、状态、返回值、执行时间、执行耗时和运维操作等信息。",-1),B=l("p",null,"当某个功能出现问题时，能够清晰打印 SQL 语句和执行的功能模块，示例如下图所示。",-1),C=a("",7),b=l("p",null,"通常建议使用 Percona Xtrabackup 物理全备和 mysqldump 逻辑备份组合使用。",-1),P=l("p",null,"同时考虑到备份压力，对线上备份的集群分三六九等，例如每周一备、每月一备、每天一备。",-1),D=l("p",null,"备份统一使用流备份进行远程备份，同时提前 apply log 进行备份文件校验。",-1),q=l("p",null,"恢复策略可以支持通过备份集新建示例、通过备份集挂载线上集群 Slave、指定时间点恢复和 FlashBack。",-1),N=l("p",null,"备份策略支持多通道，方便扩展。当集群数增长时，通过扩容备份通道即可保证集群的备份效率。例如每个机房独享一个或 N 个备份通道，各个机房间的备份通道相互独立且互不影响。",-1),I=l("p",null,"对于备份集如何存储也是一个可优化点，我们建议是本地无备份、备份通道机存储最近 N 次备份、历史备份集压缩存储到备份池。备份池使用 MFS 是一个不错的选择，MFS 是一种容错的分布式文件系统，将数据切分成多个数据副本存储在不同的计算机节点里，备份文件的高可用性得到极大的保证。",-1),V=l("p",null,"备份文件的校验是 DBA 特别关注的一个点，不希望存在备份文件无法恢复的场景。因此在备份过程中备份文件提前通过 apply log 进行了恢复，即达到了备份文件校验的同时又加快后期备份恢复的速度。",-1),f=l("p",null,"基于这些备份恢复关注点进行 MySQL 自动化备份恢复系统开发，通过系统配置集群备份恢复变得简单。",-1),O=l("p",null,"当集群新上线或变更时， DBA 在管理平台进行备份任务部署前，需要一个指标检查：是否部署专用备份网卡。任务配置后台入库后，集群服务器上部署的 Agent 访问配置中心获取任务信息并根据规则发起备份任务，实例调度备份以流的方式向同机房备份机传输，任务结束后逐一向上层返回任务状态信息，最终在 Web 平台进行界面信息展示。",-1),k=l("p",null,"同时备份文件会在同机房备份机进行压缩，以 RSYNC 的方式同步到 MFS 备份池。至此，一次备份任务完成。DBA 只需要部署备份任务、查看任务状态即可，不再需要过多的人工介入备份任务中。",-1),R=a("",5),x=a("",6),U=a("",8);function G(v,K,w,H,Y,J){const p=e("Image");return s(),_("div",null,[n,t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/91/CgoB5l2h2MCAG5P5AAJ0Tgb1X9g202.png"}),i(),c,t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/B1/CgotOV2h2MCAV9W7AADW56YaHI4646.png"}),i(),t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/92/CgoB5l2h2MCAa6jrAAGPJ6qvKG8834.png"}),i(),r,t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/B1/CgotOV2h2MGAeVp_AAE1aDeVH2A336.png"}),i(),t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/92/CgoB5l2h2MGAKYDyAADOa-uD24Q832.png"}),i(),L,h,Q,M,d,A,g,t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/B1/CgotOV2h2MGAQrNyAACb_hINN-Y277.png"}),i(),m,t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/92/CgoB5l2h2MGAKyeOAAAwxPTtr5A564.png"}),i(),u,t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/B1/CgotOV2h2MKAYDQrAABo5qKQ2ZQ892.png"}),i(),y,t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/92/CgoB5l2h2MKAeCa-AACSi3YXKn0288.png"}),i(),T,t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/B1/CgotOV2h2MKAfKn8AAGE8M8KkB8237.png"}),i(),E,B,t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/92/CgoB5l2h2MKAefO-AAIoHa-yt4Y677.png"}),i(),C,t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/B1/CgotOV2h2MOAJhzFAAEAWAe64mU821.png"}),i(),b,P,D,q,N,I,t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/92/CgoB5l2h2MOAFj6IAABgowJcfzw368.png"}),i(),V,t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/B1/CgotOV2h2MOAJndNAAA4zfZOqEA897.png"}),i(),f,t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/92/CgoB5l2h2MOAOynJAAJbOLzenxc197.png"}),i(),O,k,t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/B1/CgotOV2h2MSACXlZAAGT71aB4Sg117.png"}),i(),R,t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/92/CgoB5l2h2MSAQYuTAAKr38IGBvg495.png"}),i(),x,t(p,{alt:"",src:"http://s0.lgstatic.com/i/image2/M01/98/B1/CgotOV2h2MSAMZK3AAHurrtI1S0034.png"}),i(),U])}const X=o(S,[["render",G]]);export{F as __pageData,X as default};
